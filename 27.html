<html lang="de"><head>
<meta charset="utf-8"/>
<title>Lesen Teil 1 - Insekten</title>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
<style>
    :root {
      --primary-color: #3498db;
      --secondary-color: #2ecc71;
      --danger-color: #e74c3c;
      --light-bg: #ecf0f1;
      --dark-text: #2c3e50;
      --light-text: #ffffff;
      --border-radius: 10px;
      --box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      --box-shadow-hover: 0 8px 20px rgba(0,0,0,0.15);
    }
    *, *::before, *::after { box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', 'Roboto', Arial, sans-serif; margin: 0; padding: 10px;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); color: var(--dark-text);
      animation: fadeInPage 0.8s ease-out; min-height: 100vh;
    }
    @media (min-width: 600px) { body { padding: 15px; } }
    @media (min-width: 992px) { body { padding: 20px; } }
    @keyframes fadeInPage { from { opacity: 0; transform: translateY(-15px); } to { opacity: 1; transform: translateY(0); } }
    .main-header {
      background-color: var(--primary-color); color: var(--light-text); padding: 12px 15px;
      font-size: 20px; margin-bottom: 20px; border-radius: var(--border-radius);
      text-align: center; font-weight: 600; box-shadow: var(--box-shadow); letter-spacing: 0.5px;
    }
    @media (min-width: 768px) { .main-header { padding: 20px 25px; font-size: 26px; margin-bottom: 25px; } }
    .container { display: flex; flex-direction: row; justify-content: space-between; gap: 15px; }
    @media(min-width: 992px) { .container { gap: 20px; } }
    .left-column { width: 58%; flex-shrink: 0; }
    .right-column { width: 38%; flex-shrink: 0; }
    .quiz-scroll-container, .right-column-content {
      background-color: var(--light-text); border-radius: var(--border-radius); padding: 10px;
      box-shadow: var(--box-shadow); max-height: 75vh; overflow-y: auto; overflow-x: hidden;
      scrollbar-width: thin; scrollbar-color: var(--primary-color) var(--light-bg);
    }
    @media (min-width: 992px) { .quiz-scroll-container, .right-column-content { padding: 15px; max-height: 70vh; } }
    .quiz-scroll-container::-webkit-scrollbar, .right-column-content::-webkit-scrollbar { width: 6px; }
    @media (min-width: 992px) { .quiz-scroll-container::-webkit-scrollbar, .right-column-content::-webkit-scrollbar { width: 8px; } }
    .quiz-scroll-container::-webkit-scrollbar-track, .right-column-content::-webkit-scrollbar-track { background: var(--light-bg); border-radius: var(--border-radius); }
    .quiz-scroll-container::-webkit-scrollbar-thumb, .right-column-content::-webkit-scrollbar-thumb { background-color: var(--primary-color); border-radius: var(--border-radius); border: 2px solid var(--light-bg); }
    .question-box {
      border: 1px solid #bdc3c7; border-left: 4px solid var(--primary-color); border-radius: var(--border-radius);
      margin-bottom: 15px; padding: 10px; background-color: #fdfdfd;
      transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
      display: flex; flex-direction: column; min-height: 120px;
    }
    @media (min-width: 992px) { .question-box { border-left-width: 5px; margin-bottom: 20px; padding: 15px; min-height: 150px; } }
    .question-box:hover { transform: translateY(-3px); box-shadow: var(--box-shadow-hover); }
    .email-fields { margin-bottom: 8px; }
    @media (min-width: 992px) { .email-fields { margin-bottom: 10px; } }
    .drop-target {
      background-color: #f9f9f9; padding: 10px; border: 2px dashed #cccccc; min-height: 40px;
      border-radius: 6px; text-align: center; transition: background-color 0.3s, border-color 0.3s;
      display: flex; align-items: center; justify-content: center; position: relative; cursor: pointer; /* Added cursor */
    }
    @media (min-width: 992px) { .drop-target { padding: 12px; min-height: 45px; border-radius: 8px; } }
    .drop-target.empty-drop-target::before { content: "Drop here"; color: #aaa; font-style: italic; font-size: 0.8em; }
    @media (min-width: 992px) { .drop-target.empty-drop-target::before { content: "Antwort hier ablegen"; font-size: 0.9em; } }
    .drop-target:not(.empty-drop-target)::before { content: ""; }
    .drop-target:hover, .drop-target.drag-over { background-color: #eef8ff; border-color: var(--primary-color); }
    .question-text { font-size: 0.8em; color: #555; line-height: 1.5; overflow-y: auto; max-height: 200px; padding-right: 5px; }
    @media (min-width: 992px) { .question-text { font-size: 0.9em; line-height: 1.6; max-height: 300px; } }
    .draggable {
      background-color: #e0e0e0; color: var(--dark-text); margin: 8px 0; padding: 8px 10px;
      border-radius: 6px; cursor: grab; display: flex; align-items: center; justify-content: center;
      transition: background-color 0.3s, transform 0.2s, box-shadow 0.2s, outline 0.2s;
      user-select: none; font-size: 0.85em; box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      text-align: center; word-break: break-word;
    }
    @media (min-width: 992px) { .draggable { margin: 10px 0; padding: 12px 15px; border-radius: 8px; font-size: 0.95em; } }
    .draggable:hover { background-color: #d0d0d0; transform: scale(1.02); box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
    .draggable.dragging { opacity: 0.6; transform: scale(0.95); box-shadow: 0 10px 20px rgba(0,0,0,0.2); cursor: grabbing; }

    /* NEW CSS for selected draggable */
    .draggable.selected {
      outline: 3px solid var(--primary-color);
      transform: scale(1.03);
      box-shadow: 0 0 10px rgba(52, 152, 219, 0.5);
      background-color: #ddeeff;
    }
    .draggable.selected:hover {
        background-color: #cce7ff;
        transform: scale(1.03);
    }

    .drop-target.correct { background-color: #e8f5e9 !important; border: 2px solid var(--secondary-color) !important; }
    .drop-target.correct::after {
      content: "\f00c"; font-family: "Font Awesome 6 Free"; font-weight: 900; color: var(--secondary-color);
      position: absolute; right: 5px; top: 50%; transform: translateY(-50%); font-size: 1em;
    }
    @media (min-width: 992px) { .drop-target.correct::after { right: 10px; font-size: 1.2em; } }
    .drop-target.incorrect { background-color: #ffebee !important; border: 2px solid var(--danger-color) !important; }
    .drop-target.incorrect::after {
      content: "\f00d"; font-family: "Font Awesome 6 Free"; font-weight: 900; color: var(--danger-color);
      position: absolute; right: 5px; top: 50%; transform: translateY(-50%); font-size: 1em;
    }
    @media (min-width: 992px) { .drop-target.incorrect::after { right: 10px; font-size: 1.2em; } }
    .drop-target .draggable { background-color: var(--primary-color); color: var(--light-text); width: calc(100% - 25px); padding-right: 0; margin: 0; }
    @media (min-width: 992px) { .drop-target .draggable { width: calc(100% - 40px); } }
    .drop-target.correct .draggable { background-color: var(--secondary-color) !important; }
    .drop-target.incorrect .draggable { background-color: var(--danger-color) !important; }
    .button-container { margin-top: 20px; display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; }
    @media (min-width: 992px) { .button-container { margin-top: 25px; gap: 15px; } }
    .quiz-button, .quiz-button-link {
      padding: 10px 20px; border: none; background-color: var(--primary-color); color: white !important;
      font-size: 14px; font-weight: 500; border-radius: var(--border-radius); cursor: pointer;
      transition: background-color 0.3s, transform 0.2s, box-shadow 0.2s;
      display: inline-flex; align-items: center; justify-content: center; gap: 8px;
      box-shadow: var(--box-shadow); text-decoration: none;
    }
    @media (min-width: 992px) { .quiz-button, .quiz-button-link { padding: 12px 25px; font-size: 16px; } }
    .quiz-button:hover, .quiz-button-link:hover { background-color: #2980b9; transform: translateY(-2px); box-shadow: var(--box-shadow-hover); color: white !important; }
    .quiz-button:active, .quiz-button-link:active { transform: translateY(0px); box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    .quiz-button.secondary, .quiz-button-link.secondary { background-color: #7f8c8d; }
    .quiz-button.secondary:hover, .quiz-button-link.secondary:hover { background-color: #6c7a89; }
    #result {
      text-align: center; margin-top: 20px; padding: 12px; font-size: 1em; font-weight: 500;
      background-color: var(--light-text); border-radius: var(--border-radius); box-shadow: var(--box-shadow);
    }
    @media (min-width: 992px) { #result { margin-top: 25px; padding: 15px; font-size: 1.1em; } }
    #result .correct-count { color: var(--secondary-color); }
    #result .total-count { color: var(--primary-color); }

    #warningBox {
  display: none;
  position: fixed;
  top: 20px;                  
  left: 50%;                  
  transform: translateX(-50%);
  background: #f81d1d;
  color: #ffffff;
  padding: 15px 20px;
  border-radius: 10px;
  box-shadow: 0 0 10px rgba(0,0,0,0.3);
  font-family: Arial, sans-serif;
  font-size: 14px;
  font-weight: bold;
  z-index: 9999;
}
  </style>
</head>
<body>
<div class="main-header">Lesen Teil 1 - Insekten</div>
<div class="container">
<div class="left-column">
<div class="quiz-scroll-container">
<!-- Question 1 -->
<div class="question-box" data-correct="Landwirte wollen Gift gegen sch√§dliche Insekten einsetzen/Bauern sind gezwungen, Gift gegen sch√§dliche Insekten einsetzen.">
<div class="email-fields">
<div class="email-subject drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)"></div>
</div>
<div class="question-text">
          Die anhaltend au√üergew√∂hnlich hohen Temperaturen haben im S√ºden Frankreichs eine Tierplage unbekannten Ausma√ües ausgel√∂st. Bei den Plagegeistern handelt es sich um Unmengen von zwei bis dreieinhalb Zentimeter langen Heuschrecken, den sogenannten Roten Schnarrschrecken. Die dunklen Insekten fressen Felder und Wiesen kahl und haben innerhalb von rund sechs Wochen die Landschaft in eine trostlose Steppe verwandelt. Die Landwirte der Region sind bereits verzweifelt, denn ihre gesamte Ernte hat sich buchst√§blich in Luft aufgel√∂st. Wenn man √ºber ein befallenes Feld geht, springt bei jedem Schritt ein Schwarm Schnarrschrecken auf. Der Name dieser heimischen Tierart hat √ºbrigens einen ganz einfachen Ursprung: Die Heuschrecken machen beim Springen ein lautes Ger√§usch ‚Äì sie schnarren also ‚Äì und ihre leuchtend roten Hinterfl√ºgel sind gut sichtbar. Daher der Name "Rote Schnarrschrecke‚Äú. Manche Experten vermuten, dass die Heuschreckenplage durch einen drastischen Klimawandel ausgel√∂st wird. Die damit verbundene Aufheizung mache S√ºdeuropa immer ‚Äûafrikanischer‚Äú. Ein deutscher Wissenschaftsautor wies k√ºrzlich im Internet mehrfach darauf hin, dass es im Laufe der Erdgeschichte st√§ndig einen Wechsel von Warmzeiten und Kaltzeiten gegeben habe, der keineswegs abgeschlossen sei. Zeitweise habe das Gebiet von Europa nahe am √Ñquator gelegen. Der Einsatz von Gift gegen die Heuschrecken ist sehr riskant. Es darf nur ein Mittel verwendet werden, das ausschlie√ülich f√ºr die Heuschrecken t√∂dlich ist, nicht aber f√ºr Bienen und andere Insekten. Auch das Vieh der Bauern darf nicht durch verseuchtes Futter gef√§hrdet werden. Die einzige gute Nachricht: F√ºr Menschen und andere Tiere sind die Heuschrecken v√∂llig ungef√§hrlich.
          </div>
</div>
<!-- Question 2 -->
<div class="question-box" data-correct="R√ºckblick: Fischsterben im Rhein.">
<div class="email-fields">
<div class="email-subject drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)"></div>
</div>
<div class="question-text">
          F√ºr immer wird eine der gr√∂√üten Umweltkatastrophen mit dem Namen des damals in Basel ans√§ssigen Chemiekonzerns Sandoz verbunden bleiben, der heute zu Novartis geh√∂rt. Im Jahr 1986 f√ºhrte ein Brand in einer Lagerhalle des Konzerns zu einer Verunreinigung des Rheins mit 20 Tonnen hochgiftiger Pestizide und Insektizide. Auf einer L√§nge von 450 Kilometern kam es zu einem massiven Fischsterben, wobei vor allem Aale betroffen waren. Trinkwasser konnte nicht mehr aus dem Fluss gewonnen werden.
          Der √∂ffentliche Druck, der als Reaktion auf die Umweltkatastrophe entstand, f√ºhrte zu gro√üen Investitionen in den Gew√§sserschutz. Im Rahmen des ‚ÄûAktionsprogramms Rhein‚Äú wurden rund 60 Milliarden Euro in den Ausbau von Kl√§ranlagen entlang des Rheinufers investiert. Viele Schwermetalle wie Kupfer, Cadmium, Blei und Quecksilber konnten reduziert und teilweise sogar vollst√§ndig aus dem Rhein verbannt werden. Angesichts der ergriffenen Ma√ünahmen spricht die Internationale Kommission zum Schutz des Rheins (IKSR) heute wieder von ‚Äûguter Wasserqualit√§t‚Äú des Rheins. 63 Fischarten sind wieder im Rhein vertreten, darunter auch Lachse.
          Die Aufgaben des Gew√§sserschutzes sind jedoch noch nicht abgeschlossen. Zink, Kupfer und Cadmium sowie Pestizide und Stickstoff bereiten weiterhin Sorgen. K√ºrzlich warnte das Verbraucherschutzministerium des Landes Nordrhein-Westfalen vor dem Verzehr von Rheinfischen unterhalb von Duisburg, weil Tenside durch die Nebenfl√ºsse M√∂hne und Ruhr in den Rhein gelangt waren.
        </div>
</div>
<!-- Question 3 -->
<div class="question-box" data-correct="Kleine Plagegeister k√∂nnen Krankheiten bringen.">
<div class="email-fields">
<div class="email-subject drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)"></div>
</div>
<div class="question-text">
          Der Klimawandel in Verbindung mit der Globalisierung f√ºhrt dazu, dass in Deutschland zunehmend Tiere heimisch werden, die hier zuvor nicht beobachtet wurden. Zu diesen Neuank√∂mmlingen geh√∂ren auch exotische Stechm√ºcken, wie beispielsweise der japanische Buschmoskito. Mit den exotischen Stechm√ºcken kommen auch neue Infektionserreger nach Deutschland, die m√∂glicherweise bisher unbekannte Krankheiten beim Menschen ausl√∂sen k√∂nnen. Eine Forschergruppe identifizierte nun einige Erreger, die bisher nur in Afrika und Asien vorkamen. Anfang 2011 wurde ein interdisziplin√§res Projekt ins Leben gerufen. Ein erstes Ziel der Forschungsarbeit ist die Erstellung einer M√ºckenkarte f√ºr Deutschland. "Innerhalb weniger Jahre wollen wir einen √úberblick √ºber die Artenverteilung der M√ºcken haben und wissen, welche Viren in ihnen stecken", so Professor Dr. Sven Klimpel, der Leiter des Bernhard-Nocht Instituts. Das Bernhard-Nocht-Institut ist eine international anerkannte Forschungseinrichtung, die eine langj√§hrige Erfahrung in der Virendiagnostik in das Projekt einbringt. Es verf√ºgt √ºber Labore der h√∂chsten Sicherheitsstufe, die erforderlich sind, um neue Viren mit unbekanntem Gef√§hrdungspotential zu untersuchen. Mit den neu entdeckten, aus Asien stammenden M√ºckenarten konnten in Deutschland bislang 48 Stechm√ºckenarten von Entomologen nachgewiesen werden. Seit einigen Jahren breitet sich die Malariam√ºcke Anopheles plumbeus in S√ºdwestdeutschland aus. Auch die Asiatische Tigerm√ºcke, die unter anderem das gef√§hrliche Denguefieber verbreitet, schaffte es 2018 in die Schlagzeilen, weil sie am Rhein gefunden wurde.
        </div>
</div>
<!-- Question 4 -->
<div class="question-box" data-correct="Neue Studie: nicht nur Affen und Delfine erkennen sich selbst.">
<div class="email-fields">
<div class="email-subject drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)"></div>
</div>
<div class="question-text">
          Forscher haben bei Versuchen im Bronx Zoo in New York eine neue Erkenntnis √ºber Elefanten erlangt: Sie k√∂nnen sich selbst im Spiegel erkennen. Zumindest eines von drei Versuchstieren versuchte, einen auf seinem Kopf aufgemalten Fleck, der im Spiegelbild zu sehen war, zu entfernen. Bisher war unter anderem von Affen, Delfinen und Elstern ein √§hnliches Verhalten bekannt. Und auch bei diesen reagierte nicht immer alle Versuchstiere auf einen Spiegel. Es gab auch schon in der Vergangenheit solche Tests mit Elefanten, die aber auf keine Selbsterkenntnis schlie√üen lie√üen. Den Grund sieht ein Wissenschaftler im Versuchsaufbau: "Das gro√üe Problem ist, einen Spiegel zu haben, der 'elefantenfest' ist." Fr√ºhere Versuche h√§tten zu kleine und zu schwer zug√§ngliche Spiegel verwendet. Die Elefanten aber wollten "dagegen knallen, dahinter schauen, die Sache ausprobieren, bevor sie verstehen, was vor sich geht". Deshalb wurde diesmal ein 2,5 mal 2,5 Meter gro√üer Spiegel in einem Elefantengehege mit drei weiblichen asiatischen Elefanten montiert, der stabil genug f√ºr ausgiebige Untersuchungen durch die Tiere war. Bei √§hnlichen Tests mit Affen und Delfinen gibt es normalerweise vier Phasen der Erkenntnis im Spiegel: Zuerst der Versuch der Kommunikation mit dem vermeintlichen Artgenossen, dann eine physische Inspektion des Spiegels, ein Testen des Verhaltens des Spiegelbilds und schlie√ülich die Selbsterkenntnis. Die Elefanten √ºbersprangen die erste Phase und schauten in Phase zwei hinter den Spiegel und griffen auch mit dem R√ºssel dahinter. In Phase drei f√ºhrten sie verschiedene Bewegungen durch und verglichen sie mit denen des Spiegelbildes. Auch wenn sich dann nur eines der Tiere selbst erkannte, indem es den aufgemalten Fleck untersuchte und nach einiger Zeit dann auch das Interesse an dem Fleck verlor, sehen die Wissenschaftler das Ergebnis als eindeutigen Beweis f√ºr die F√§higkeit zur Selbsterkenntnis. Als N√§chstes wollen sie die F√§higkeiten von Elefanten auch in ihrer nat√ºrlichen Umgebung weiter erforschen.
        </div>
</div>
<!-- Question 5 -->
<div class="question-box" data-correct="Um die Zukunft der Nordsee ist es schlecht bestellt.">
<div class="email-fields">
<div class="email-subject drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)"></div>
</div>
<div class="question-text">
          Heute und morgen tagt in G√∂teborg die Internationale Nordseekonferenz (INK), an der Regierungsvertreter der acht Nordsee-Anrainerstaaten teilnehmen. Der World Wide Fund For Nature (WWF) kritisierte in diesem Zusammenhang, dass dies das letzte Treffen dieser Art sei. K√ºnftig sollen Fragen der Nordsee auf europ√§ischer Ebene behandelt werden. Der WWF bef√ºrchtet, dass die Ber√ºcksichtigung √∂kologischer Belange der Nordsee k√ºnftig im europ√§ischen Rahmen vernachl√§ssigt werde: "Es sieht nicht gut aus f√ºr die Nordsee", so fasste WWF-Meeressch√ºtzer Stefan Lutter diese Besorgnis in Worte. Der WWF ist der Ansicht, dass auf den Treffen der INK richtungsweisende Beschl√ºsse zum Nordseeschutz gefasst worden seien. Das Problem sei allerdings die Umsetzung dieser Beschl√ºsse in politisches Handeln in den Anrainerstaaten. Zu diesen Beschl√ºssen geh√∂rte beispielsweise das 2001 vereinbarte Abkommen zum Verbot giftiger Schiffsfarben sowie ein weiteres Abkommen, das die Verunreinigung der Nordsee durch von Schiffen abgelassenes Ballastwasser bek√§mpfen sollte. Diese Abkommen wurden erst zum Teil umgesetzt. Der WWF bef√ºrchtet nun, dass diese wichtigen INK-Initiativen unter den Tisch fallen k√∂nnten. Anl√§sslich des letzten Treffens der Anrainerstaaten erneuerte der WWF seine Kritik an der Fischereipolitik. Das Ziel einer nachhaltigen Fischereipolitik stehe zwar auf der Tagesordnung der Konferenz, die allt√§gliche Praxis in der EU sei jedoch durch die "Pl√ºnderung der Fischbest√§nde" gekennzeichnet. Die Kabeljaubest√§nde st√ºnden kurz vor dem Zusammenbruch, sagte der WWF-Fischereiexperte. Ein notwendiger Fangstopp f√ºr diese Fischart sei jedoch nicht geplant. Ein weiteres ungel√∂stes Problem sei das Beifang-Problem. Der WWF-Sprecher brachte dazu folgendes Rechenbeispiel: Auf jedes Kilo Plattfisch, das auf den Tellern lande, gingen √ºber f√ºnf Kilo ungenutzter Beifang in die Netze der Fangflotten.</div>
</div>
</div>
</div>
<div class="right-column">
<div class="right-column-content" ondragover="allowDrop(event)" ondrop="drop(event)">
<div class="draggable" draggable="true" id="a1" ondragstart="drag(event)">Neue Heuschreckenart in Frankreich entdeckt Insektenart.</div>
<div class="draggable" draggable="true" id="a2" ondragstart="drag(event)">Kleine Plagegeister k√∂nnen Krankheiten bringen.</div>
<div class="draggable" draggable="true" id="a3" ondragstart="drag(event)">Landwirte wollen Gift gegen sch√§dliche Insekten einsetzen/Bauern sind gezwungen, Gift gegen sch√§dliche Insekten einsetzen.</div>
<div class="draggable" draggable="true" id="a4" ondragstart="drag(event)">Neue Mittel gegen M√ºcken.</div>
<div class="draggable" draggable="true" id="a5" ondragstart="drag(event)">Neue Studie: nicht nur Affen und Delfine erkennen sich selbst.</div>
<div class="draggable" draggable="true" id="a6" ondragstart="drag(event)">Probleme beim Versuchsaufbau: Studie gescheitert.</div>
<div class="draggable" draggable="true" id="a7" ondragstart="drag(event)">Rhein nach Chemieunfall noch immer tot.</div>
<div class="draggable" draggable="true" id="a8" ondragstart="drag(event)">R√ºckblick: Fischsterben im Rhein.</div>
<div class="draggable" draggable="true" id="a9" ondragstart="drag(event)">Um die Zukunft der Nordsee ist es schlecht bestellt.</div>
<div class="draggable" draggable="true" id="a10" ondragstart="drag(event)">WWF zieht positive Bilanz f√ºr die Nordsee.</div>
</div>
</div>
</div>
<div class="button-container">
<button class="quiz-button" onclick="submitQuiz()">
<i class="fas fa-paper-plane"></i> Abschicken
  </button>
<button class="quiz-button secondary" onclick="resetQuiz()">
<i class="fas fa-redo"></i> Zur√ºcksetzen
  </button>
<a class="quiz-button-link secondary" href="/index2"> <!-- Replace # with your actual home link -->
<i class="fas fa-home"></i> Zur√ºck zur Startseite
  </a>
</div>
<div id="result"></div>
<script>
  const rightColumnContent = document.querySelector(".right-column .right-column-content");
  const originalAnswerOrder = Array.from(rightColumnContent.querySelectorAll('.draggable'));
  let selectedDraggable = null; // To store the currently click-selected draggable item

  // --- CLICK-TO-DROP/PICKUP LOGIC ---
  function selectItem(item) {
    if (selectedDraggable) {
      selectedDraggable.classList.remove('selected');
    }
    selectedDraggable = item;
    if (selectedDraggable) {
      selectedDraggable.classList.add('selected');
    }
  }

  function deselectItem() {
    if (selectedDraggable) {
      selectedDraggable.classList.remove('selected');
      selectedDraggable = null;
    }
  }

  function handleDraggableClicked(event) {
    const clickedItem = event.currentTarget;
    event.stopPropagation(); // Prevent click bubbling to parent elements like answer pool

    if (selectedDraggable === clickedItem) { // Clicking the already selected item
      deselectItem();
      // If it was in a target and now deselected by clicking it, move it back to pool
      if (clickedItem.parentElement.classList.contains('drop-target')) {
           const parentDropTarget = clickedItem.parentElement;
           rightColumnContent.appendChild(clickedItem);
           updateDropTargetVisualState(parentDropTarget);
           parentDropTarget.classList.remove('correct', 'incorrect'); // Clear feedback
      }
    } else { // Clicking a new item, or an unselected item in a target
      // If the clicked item is currently in a drop target, "pick it up" by moving to pool first
      if (clickedItem.parentElement.classList.contains('drop-target')) {
          const parentDropTarget = clickedItem.parentElement;
          rightColumnContent.appendChild(clickedItem); // Move to pool
          updateDropTargetVisualState(parentDropTarget);
          parentDropTarget.classList.remove('correct', 'incorrect'); // Clear feedback
      }
      selectItem(clickedItem); // Then select it (it's now in the pool)
    }
  }

  function handleDropTargetClicked(event) {
    const clickedDropTarget = event.currentTarget;
    event.stopPropagation();

    if (selectedDraggable) { // If an item is selected, try to place it here
      const existingItemInTarget = clickedDropTarget.querySelector('.draggable');
      if (existingItemInTarget && existingItemInTarget !== selectedDraggable) {
        rightColumnContent.appendChild(existingItemInTarget); // Move old item from target back to pool
        // No need to deselect existingItemInTarget here, as it wasn't the 'selectedDraggable'
      }

      clickedDropTarget.innerHTML = ''; // Clear target (removes placeholder or old item)
      clickedDropTarget.appendChild(selectedDraggable); // Place new item
      updateDropTargetVisualState(clickedDropTarget);
      clickedDropTarget.classList.remove('correct', 'incorrect'); // Clear any feedback
      deselectItem(); // Item is placed, so deselect
    } else if (!selectedDraggable && clickedDropTarget.querySelector('.draggable')) {
      // No item is selected, AND the clicked drop target HAS an item: "pick up" that item.
      const itemToPickUp = clickedDropTarget.querySelector('.draggable');
      rightColumnContent.appendChild(itemToPickUp); // Move it to the pool
      updateDropTargetVisualState(clickedDropTarget);
      clickedDropTarget.classList.remove('correct', 'incorrect'); // Clear feedback
      selectItem(itemToPickUp); // And select it (it's now in the pool)
    }
  }

  function handleAnswerPoolClicked(event) {
    // If click is on the pool itself (not a draggable within it) and an item is selected
    if (event.target === rightColumnContent && selectedDraggable) {
      // If selected item is somehow not in pool (e.g. if logic changes), ensure it is
      if (selectedDraggable.parentElement !== rightColumnContent) {
           rightColumnContent.appendChild(selectedDraggable);
      }
      // The main purpose here: clicking the pool with a selected item deselects it.
      deselectItem();
    }
  }

  function initializeClickInteractions() {
    document.querySelectorAll('.draggable').forEach(item => {
      item.addEventListener('click', handleDraggableClicked);
    });
    document.querySelectorAll('.drop-target').forEach(target => {
      target.addEventListener('click', handleDropTargetClicked);
    });
    rightColumnContent.addEventListener('click', handleAnswerPoolClicked);
  }

  // --- DRAG AND DROP LOGIC (MODIFIED) ---
  function allowDrop(ev) {
    ev.preventDefault();
    let potentialDropTarget = ev.target;
    while(potentialDropTarget && !potentialDropTarget.classList.contains('drop-target') && !potentialDropTarget.classList.contains('right-column-content')) {
        potentialDropTarget = potentialDropTarget.parentElement;
    }
    if (potentialDropTarget && potentialDropTarget.classList.contains('drop-target')) {
        potentialDropTarget.classList.add("drag-over");
    }
  }

  document.addEventListener('dragleave', function(event) {
    if (event.target.classList && event.target.classList.contains("drop-target")) {
      event.target.classList.remove("drag-over");
    }
  }, false);

  function drag(ev) {
    ev.dataTransfer.setData("text", ev.target.id);
    ev.target.classList.add("dragging");
    deselectItem(); // Deselect any click-selected item when a drag operation starts
  }

  document.addEventListener('dragend', function(event) {
    if (event.target.classList && event.target.classList.contains('draggable')) {
      event.target.classList.remove('dragging');
    }
    document.querySelectorAll('.drop-target.drag-over').forEach(dt => dt.classList.remove('drag-over'));
  });

  function drop(ev) {
    ev.preventDefault();
    const draggedId = ev.dataTransfer.getData("text");
    const draggedEl = document.getElementById(draggedId);
    let dropTargetEl = ev.target;

    if (!draggedEl) return; // Safety check

    draggedEl.classList.remove("dragging");
    document.querySelectorAll('.drop-target.drag-over').forEach(dt => dt.classList.remove('drag-over'));

    while (dropTargetEl &&
           !dropTargetEl.classList.contains("drop-target") &&
           !dropTargetEl.classList.contains("right-column-content")) {
      dropTargetEl = dropTargetEl.parentElement;
    }

    if (!dropTargetEl) return;

    if (dropTargetEl.classList.contains("drop-target")) {
      const currentAnswer = dropTargetEl.querySelector(".draggable");
      if (currentAnswer && currentAnswer !== draggedEl) {
        rightColumnContent.appendChild(currentAnswer);
        currentAnswer.classList.remove('selected'); // Ensure item moved back is not selected
      }
      dropTargetEl.innerHTML = "";
      dropTargetEl.appendChild(draggedEl);
      dropTargetEl.classList.remove("correct", "incorrect");
      updateDropTargetVisualState(dropTargetEl);
    }
    else if (dropTargetEl.classList.contains("right-column-content")) {
      const originalParent = draggedEl.parentElement; // Get parent BEFORE moving
      rightColumnContent.appendChild(draggedEl);
      if (originalParent && originalParent.classList.contains('drop-target')) {
          updateDropTargetVisualState(originalParent); // Update visual state of original drop target
          originalParent.classList.remove('correct', 'incorrect');
      }
    }
    deselectItem(); // Deselect any click-selected item after a drop operation
  }

  function updateDropTargetVisualState(dropTarget) {
    if (!dropTarget || !dropTarget.classList.contains('drop-target')) return;
    if (dropTarget.querySelector(".draggable")) {
      dropTarget.classList.remove("empty-drop-target");
    } else {
      dropTarget.classList.add("empty-drop-target");
    }
  }

  // --- QUIZ FUNCTIONALITY (MODIFIED RESET) ---
  function submitQuiz() {
    let total = 0;
    let correct = 0;
    deselectItem(); // Ensure nothing is selected when submitting

    document.querySelectorAll('.question-box').forEach((box) => {
      total++;
      const correctAnswer = box.getAttribute("data-correct").trim();
      const dropTarget = box.querySelector(".drop-target");
      const droppedDraggable = dropTarget.querySelector(".draggable");
      dropTarget.classList.remove("correct", "incorrect");
      if (droppedDraggable) {
        const selectedText = droppedDraggable.textContent.trim();
        if (selectedText === correctAnswer) {
          dropTarget.classList.add("correct");
          correct++;
        } else {
          dropTarget.classList.add("incorrect");
        }
      } else {
        dropTarget.classList.add("incorrect");
      }
    });
    const resultDiv = document.getElementById("result");
    resultDiv.innerHTML =
      `Du hast <span class="correct-count">${correct}</span> von <span class="total-count">${total}</span> Fragen richtig beantwortet.`;
  }

  function resetQuiz() {
    deselectItem(); // Clear any click-selection first

    document.querySelectorAll('.drop-target').forEach(dt => {
        const draggable = dt.querySelector('.draggable');
        if (draggable) {
            rightColumnContent.appendChild(draggable);
            draggable.classList.remove('selected'); // Make sure it's not selected style
        }
        dt.innerHTML = '';
        dt.classList.remove('correct', 'incorrect');
        updateDropTargetVisualState(dt);
    });

    rightColumnContent.innerHTML = '';
    originalAnswerOrder.forEach(draggable => {
        rightColumnContent.appendChild(draggable);
        draggable.classList.remove('dragging'); // Just in case
        draggable.classList.remove('selected'); // Ensure no selected style
    });

    document.getElementById("result").innerHTML = "";
    document.querySelectorAll('.drop-target').forEach(updateDropTargetVisualState);
  }

  // --- INITIALIZATION ---
  document.querySelectorAll('.drop-target').forEach(updateDropTargetVisualState);
  initializeClickInteractions(); // Add this line to set up click listeners

</script>
<script>
let pingTimeout;
let logoutTimer;
let warningTimer;
let countdownTimer;
let lastPing = 0;

const INACTIVITY_LIMIT = 15 * 60 * 1000; // 15 minutes
const WARNING_BEFORE_LOGOUT = 30 * 1000; // 30 seconds
const warningBox = document.getElementById("warningBox");
const countdownEl = document.getElementById("countdown");

function sendPing() {
    const now = Date.now();
    if (now - lastPing < 10000) return; 
    lastPing = now;
    fetch("/ping").catch(() => {});
}

function resetTimers() {
    clearTimeout(pingTimeout);
    clearTimeout(logoutTimer);
    clearTimeout(warningTimer);
    clearInterval(countdownTimer);

    warningBox.style.display = "none"; // üü° hide warning if active again

    sendPing();
    pingTimeout = setTimeout(sendPing, 60 * 1000);

    // Show warning 30s before logout
    warningTimer = setTimeout(() => {
        let remaining = 30;
        warningBox.style.display = "block";
        countdownEl.textContent = remaining;

        countdownTimer = setInterval(() => {
            remaining--;
            countdownEl.textContent = remaining;
            if (remaining <= 0) {
                clearInterval(countdownTimer);
            }
        }, 1000);
    }, INACTIVITY_LIMIT - WARNING_BEFORE_LOGOUT);

    // Auto logout
    logoutTimer = setTimeout(() => {
        fetch("/logout", { method: "POST" })
          .then(() => window.location.href = "/");
    }, INACTIVITY_LIMIT);
}

// Events
["mousemove", "keydown", "scroll", "click", "touchstart"].forEach(evt => {
    document.addEventListener(evt, resetTimers);
});

window.addEventListener("pageshow", sendPing);
window.addEventListener("beforeunload", sendPing);

resetTimers();
</script>
</body></html>