<html lang="de"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Teil 3 Sprachbausteine</title>
<!-- Font Awesome for Icons -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
<style>
        :root {
            --primary-color: #3498db; /* A slightly more vibrant blue */
            --secondary-color: #2ecc71; /* Green for success */
            --danger-color: #e74c3c; /* Red for error */
            --light-bg: #ecf0f1;
            --dark-text: #2c3e50;
            --light-text: #ffffff;
            --border-radius: 10px;
            --box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            --box-shadow-hover: 0 8px 20px rgba(0,0,0,0.15);
        }

        body {
            font-family: 'Segoe UI', 'Roboto', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--dark-text);
            animation: fadeInPage 0.8s ease-out;
            min-height: 100vh;
            box-sizing: border-box;
        }

        @keyframes fadeInPage {
            from { opacity: 0; transform: translateY(-15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .header {
            background-color: var(--primary-color);
            color: var(--light-text);
            padding: 20px 25px;
            margin-bottom: 25px;
            border-radius: var(--border-radius);
            text-align: center;
            font-size: 26px;
            font-weight: 600;
            box-shadow: var(--box-shadow);
            letter-spacing: 0.5px;
        }

        .game-layout { /* Acts as the .container */
            display: flex;
            flex-direction: column; /* Stack header, then content */
            gap: 20px; /* Gap between header and columns, and between columns on wider screens */
            max-width: 1200px;
            margin: 0 auto; /* Centered */
        }

        .columns-container { /* New wrapper for the two columns */
            display: flex;
            flex-direction: column; /* Mobile first */
            gap: 20px;
            width: 100%;
        }

        @media(min-width: 768px) {
            .game-layout {
                gap: 25px;
            }
            .columns-container {
                flex-direction: row; /* Side-by-side on larger screens */
                justify-content: space-between;
                align-items: flex-start;
            }
        }

        .quiz-text, .word-bank-container { /* Common styling for column wrappers */
            background-color: var(--light-text);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            max-height: 70vh; 
            overflow-y: auto;
             /* Custom scrollbar styling */
            scrollbar-width: thin;
            scrollbar-color: var(--primary-color) var(--light-bg);
        }
        .quiz-text::-webkit-scrollbar,
        .word-bank-container::-webkit-scrollbar {
          width: 8px;
        }
        .quiz-text::-webkit-scrollbar-track,
        .word-bank-container::-webkit-scrollbar-track {
          background: var(--light-bg);
          border-radius: var(--border-radius);
        }
        .quiz-text::-webkit-scrollbar-thumb,
        .word-bank-container::-webkit-scrollbar-thumb {
          background-color: var(--primary-color);
          border-radius: var(--border-radius);
          border: 2px solid var(--light-bg);
        }


        .quiz-text { /* Specific to left column */
            flex: 3;
            text-align: left;
            line-height: 1.8; /* Increased line height for readability with blanks */
        }
         .quiz-text p {
            margin-bottom: 1.5em;
        }

        .word-bank-container { /* Specific to right column wrapper */
            flex: 1;
            min-width: 250px; /* Ensure it has some width */
        }
        
        .word-bank { /* Actual container for draggable words */
            display: flex;
            flex-direction: column; /* Stack words vertically */
            gap: 10px;
        }


        .blank {
            background-color: transparent; /* Initially transparent */
            color: var(--primary-color); /* Color for the filled text */
            padding: 3px 8px;
            border-radius: 5px;
            border-bottom: 2px dashed #ccc; /* Dashed underline for empty state */
            font-weight: bold;
            cursor: pointer;
            min-width: 70px; /* Adjust as needed for average word length */
            text-align: center;
            display: inline-block;
            margin: 0 3px;
            transition: background-color 0.3s, border-color 0.3s;
            vertical-align: baseline;
        }
        .blank:hover, .blank.drag-over {
            border-bottom-color: var(--primary-color);
            background-color: #eef8ff;
        }
        /* Style for blank when it has content (JS will fill textContent) */
        .blank[data-user-answer] {
            border-bottom: 2px solid transparent; /* Remove underline when filled */
            background-color: var(--primary-color); /* Default filled style before check */
            color: var(--light-text);
        }
        /* JS will override background for correct/incorrect */


        .draggable {
            background-color: #e0e0e0;
            color: var(--dark-text);
            padding: 10px 15px; /* Adjusted padding */
            border-radius: var(--border-radius);
            cursor: grab;
            display: flex; /* Use flex for alignment if needed */
            align-items: center;
            justify-content: center; /* Center text */
            transition: background-color 0.3s, transform 0.2s, box-shadow 0.2s;
            user-select: none;
            font-size: 0.95em;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            width: 100%; /* Stack vertically */
            box-sizing: border-box;
            text-align: center;
        }
        .draggable:hover {
            background-color: #d0d0d0;
            transform: translateY(-2px); /* Subtle lift */
            box-shadow: var(--box-shadow-hover);
        }
        .draggable.selected-word-style { /* Class to be added by JS on click */
            outline: 2px solid var(--primary-color);
            box-shadow: 0 0 0 3px var(--primary-color_alpha, rgba(52, 152, 219, 0.3));
            background-color: #cce7ff;
        }
        .draggable.dragging-style { /* Class to be added by JS on dragstart */
            opacity: 0.6;
            transform: scale(0.95);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .button-container {
            margin-top: 25px;
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .quiz-button {
            padding: 12px 25px;
            border: none;
            background-color: var(--primary-color);
            color: white;
            font-size: 16px;
            font-weight: 500;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s, box-shadow 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            box-shadow: var(--box-shadow);
            text-decoration: none; /* For <a> tags styled as buttons */
        }
        .quiz-button:hover {
            background-color: #2980b9; /* Darker shade of primary */
            transform: translateY(-2px);
            box-shadow: var(--box-shadow-hover);
        }
        .quiz-button:active {
            transform: translateY(0px);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .quiz-button.secondary {
            background-color: #7f8c8d; /* A neutral secondary color */
        }
        .quiz-button.secondary:hover {
            background-color: #6c7a89;
        }


        #result {
            text-align: center;
            margin-top: 20px;
            padding: 15px;
            font-size: 1.1em;
            font-weight: 500;
            background-color: var(--light-text);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }
        #result .correct-count { color: var(--secondary-color); }
        #result .total-count { color: var(--primary-color); }

        #warningBox {
  display: none;
  position: fixed;
  top: 20px;                  
  left: 50%;                  
  transform: translateX(-50%);
  background: #f81d1d;
  color: #ffffff;
  padding: 15px 20px;
  border-radius: 10px;
  box-shadow: 0 0 10px rgba(0,0,0,0.3);
  font-family: Arial, sans-serif;
  font-size: 14px;
  font-weight: bold;
  z-index: 9999;
}

    </style>
</head>
<body>
<div class="game-layout">
<div class="header">Der kl√ºgste Freund des Menschen</div>
<div class="columns-container">
<!-- Left: Paragraph with blanks -->
<div class="quiz-text">
<h3>Wissenschaftliche Studie bescheinigt Hunden hohe Intelligenz</h3>
<p><span class="blank" data-answer="zwar"></span> gilt der Hund seit jeher als treuer Begleiter des Menschen, besondere Leistungen auf dem Gebiet der Intelligenz wurden ihm jedoch sehr viel seltener zugesprochen. Jetzt beweisen aber Untersuchungen, die etwa zeitgleich an der E√∂tv√∂s-Lor√°nd-Universit√§t in Budapest, an der Harvard Universit√§t und am Max-Planck-Institut f√ºr evolution√§re Anthropologie in Leipzig durchgef√ºhrt <span class="blank" data-answer="wurden"></span>, dass die beliebten Vierbeiner offenbar mehr verstehen und leisten k√∂nnen, als man bislang glaubte.</p>
<p>In speziell ausgearbeiteten Lerntests mit Hunden, Schimpansen und Gorillas wurde die Kommunikationsf√§higkeit der Tiere getestet. In allen Tests schnitten die Hunde besser ab als die Affen. Hunde lesen kommunikative Informationen besonders an den Augen <span class="blank" data-answer="ab"></span> , aber sie reagieren auch <span class="blank" data-answer="auf"></span> die Stimme und die K√∂rpersprache eines Menschen.</p>
<p>Ganz besonders der Blickkontakt <span class="blank" data-answer="sei"></span> f√ºr Hunde ein wichtiges Instrument, um Informationen √ºber den "Gespr√§chspartner" zu erhalten. Diese F√§higkeit habe sich im Verlaufe der Domestizierung der Hunde durch den Menschen immer weiter ausgebildet und sei jetzt in den Genen der Hunde fest verankert, so die Aussage der Forscher.</p>
<p>Hunden wird jetzt auch bescheinigt, dass sie ein Verst√§ndnis f√ºr Objekte entwickelt haben. Die Forscher versteckten vor den Augen ihrer Probanden Spielzeuge entweder hinter einer Wand oder in einem Beh√§lter. <span class="blank" data-answer="war"></span> der Beh√§lter nach dem √ñffnen leer, suchten die Hunde auch hinter der Wand nach dem Spielzeug.</p>
<p>Hundetrainer, die in anerkannten Hundeschulen arbeiten, wissen schon lange Erstaunliches √ºber die F√§higkeiten ihrer Sch√ºler zu berichten. Ein Beispiel f√ºr die erstaunlichen Leistungen, die ein Hund zustande zu bringen vermag, ist der Blindenhund. Er kann nach den entsprechenden Trainings blinden Menschen sicher den Weg zeigen, er achtet auf den Stra√üenverkehr, er leitet sie <span class="blank" data-answer="um"></span> Hindernisse herum.</p>
<p>Nach neuesten Erkenntnissen wurden die ersten Hunde vor etwa 15.000 Jahren in Ostasien domestiziert. Nach umfangreichen Erbgutuntersuchungen geht man <span class="blank" data-answer="davon"></span> aus, dass alle heute bekannten Hunderassen von etwas f√ºnf weiblichen W√∂lfen abstammen. Als Ursprungsland der heutigen Hunderassen nimmt man China an.</p>
<p>Hundebesitzer von heute k√∂nnen also stolz <span class="blank" data-answer="darauf"></span> sein, nicht nur einen anh√§nglichen, <span class="blank" data-answer="sondern"></span> auch einen intelligenten Begleiter bei sich zu haben.</p>
</div>
<!-- Right: Draggable answers -->
<div class="word-bank-container">
<div class="word-bank">
<span class="draggable" data-word="ab" draggable="true">ab</span>
<span class="draggable" data-word="aber" draggable="true">aber</span>
<span class="draggable" data-word="an" draggable="true">an</span>
<span class="draggable" data-word="auf" draggable="true">auf</span>
<span class="draggable" data-word="darauf" draggable="true">darauf</span>
<span class="draggable" data-word="dar√ºber" draggable="true">dar√ºber</span>
<span class="draggable" data-word="davon" draggable="true">davon</span>
<span class="draggable" data-word="sei" draggable="true">sei</span>
<span class="draggable" data-word="seien" draggable="true">seien</span>
<span class="draggable" data-word="sondern" draggable="true">sondern</span>
<span class="draggable" data-word="√ºber" draggable="true">√ºber</span>
<span class="draggable" data-word="um" draggable="true">um</span>
<span class="draggable" data-word="war" draggable="true">war</span>
<span class="draggable" data-word="wurden" draggable="true">wurden</span>
<span class="draggable" data-word="zwar" draggable="true">zwar</span>
</div>
</div>
</div>
</div>
<!-- Buttons and Result -->
<div class="button-container">
<button class="quiz-button" onclick="checkAnswers()"><i class="fas fa-paper-plane"></i> Antworten pr√ºfen</button>
<a class="quiz-button secondary" href="/index2">
<i class="fas fa-home"></i> Zur√ºck zur Startseite
        </a>
</div>
<div id="result"></div> <!-- Result will be shown here -->
<!-- JavaScript (slightly modified to use classes for styling feedback) -->
<script>
        let blanks = document.querySelectorAll(".blank");
        let draggables = document.querySelectorAll(".draggable");
        let selectedDraggable = null; // Stores the currently selected draggable element

        function makeDraggableClickable(draggableEl) {
            draggableEl.addEventListener("dragstart", event => {
                event.dataTransfer.setData("text", event.target.dataset.word);
                draggableEl.classList.add("dragging-style"); // Add dragging style
            });
            draggableEl.addEventListener("dragend", () => {
                draggableEl.classList.remove("dragging-style"); // Remove dragging style
            });

            draggableEl.addEventListener("click", () => {
                // Remove selected style from any previously selected draggable
                if (selectedDraggable) {
                    selectedDraggable.classList.remove("selected-word-style");
                }

                if (selectedDraggable === draggableEl) {
                    selectedDraggable = null; // Deselect if clicked again
                } else {
                    selectedDraggable = draggableEl;
                    selectedDraggable.classList.add("selected-word-style"); // Add selected style
                }
            });
        }

        draggables.forEach(makeDraggableClickable);

        blanks.forEach(blank => {
            blank.addEventListener("dragover", event => {
                event.preventDefault();
                blank.classList.add("drag-over");
            });
            blank.addEventListener("dragleave", () => {
                blank.classList.remove("drag-over");
            });

            blank.addEventListener("drop", event => {
                event.preventDefault();
                blank.classList.remove("drag-over");
                const droppedWord = event.dataTransfer.getData("text");
                const draggedEl = document.querySelector(`.draggable[data-word="${droppedWord}"]`);

                if (blank.dataset.userAnswer && blank.dataset.userAnswer !== "") {
                    restoreToWordBank(blank.dataset.userAnswer);
                }

                if (draggedEl) {
                    // Move the original draggable element from word bank to the quiz-text (hidden)
                    // or just mark it as used. For simplicity, we'll hide it.
                    draggedEl.style.display = 'none';
                }
                
                blank.textContent = droppedWord;
                blank.dataset.userAnswer = droppedWord;
                // Reset any selection from word bank
                if(selectedDraggable) {
                    selectedDraggable.classList.remove("selected-word-style");
                    selectedDraggable = null;
                }
            });

            blank.addEventListener("click", () => {
                if (!selectedDraggable) return; // Only proceed if a word is selected from bank

                const wordToFill = selectedDraggable.dataset.word;

                if (blank.dataset.userAnswer && blank.dataset.userAnswer !== "") {
                    restoreToWordBank(blank.dataset.userAnswer); // Return old word
                }

                blank.textContent = wordToFill;
                blank.dataset.userAnswer = wordToFill;

                selectedDraggable.style.display = 'none'; // Hide the used word from bank
                selectedDraggable.classList.remove("selected-word-style");
                selectedDraggable = null; // Deselect
            });
        });

        function restoreToWordBank(wordText) {
            const wordElInBank = document.querySelector(`.word-bank .draggable[data-word="${wordText}"]`);
            if (wordElInBank) {
                wordElInBank.style.display = 'flex'; // Show it again
            }
            // Note: If you were actually moving DOM elements, you'd append it back.
            // For this version, we assume words are unique and just hide/show.
        }
        
        // Make word bank droppable to return words
        const wordBankContainer = document.querySelector(".word-bank-container"); // Target the styled container
        wordBankContainer.addEventListener("dragover", event => {
            event.preventDefault();
            wordBankContainer.classList.add("drag-over"); // Visual feedback for dropping on word bank
        });
        wordBankContainer.addEventListener("dragleave", () => {
            wordBankContainer.classList.remove("drag-over");
        });
        wordBankContainer.addEventListener("drop", event => {
            event.preventDefault();
            wordBankContainer.classList.remove("drag-over");
            const droppedWord = event.dataTransfer.getData("text");
            const draggedElOriginalParent = document.querySelector(`.draggable[data-word="${droppedWord}"]`);

            // Find the blank that currently holds this word
            let sourceBlank = null;
            blanks.forEach(b => {
                if (b.dataset.userAnswer === droppedWord) {
                    sourceBlank = b;
                }
            });

            if (sourceBlank) {
                sourceBlank.textContent = ""; // Clear the blank visually (or use a placeholder like "____")
                sourceBlank.dataset.userAnswer = ""; // Clear the stored answer
                sourceBlank.style.background = ""; // Reset any feedback color
            }

            if (draggedElOriginalParent) {
                 draggedElOriginalParent.style.display = 'flex'; // Make it visible in the word bank
            }
        });


        function checkAnswers() {
            let score = 0;
            blanks.forEach(blank => {
                // Reset visual feedback before re-checking
                blank.style.background = ""; // Reset general background
                if (blank.dataset.userAnswer) { // If it's filled, apply default filled style
                    blank.style.backgroundColor = 'var(--primary-color)';
                    blank.style.color = 'var(--light-text)';
                } else {
                     blank.style.color = 'var(--primary-color)'; // Default empty text color
                }


                if (blank.dataset.userAnswer && blank.dataset.userAnswer === blank.dataset.answer) {
                    blank.style.backgroundColor = "var(--secondary-color)"; // Green for correct
                    blank.style.color = "var(--light-text)";
                    score++;
                } else if (blank.dataset.userAnswer && blank.dataset.userAnswer !== "") { // Filled but incorrect
                    blank.style.backgroundColor = "var(--danger-color)"; // Red for incorrect
                    blank.style.color = "var(--light-text)";
                } else { // Not filled, but expected an answer
                    blank.style.borderColor = "var(--danger-color)"; // Or some other indication
                    blank.style.borderBottom = "2px dashed var(--danger-color)";
                }
            });
            const resultDiv = document.getElementById("result");
            resultDiv.innerHTML = 
                `Ergebnis: <span class="correct-count">${score}</span> / <span class="total-count">${blanks.length}</span>`;
        }
    </script>
<script>
let pingTimeout;
let logoutTimer;
let warningTimer;
let countdownTimer;
let lastPing = 0;

const INACTIVITY_LIMIT = 15 * 60 * 1000; // 15 minutes
const WARNING_BEFORE_LOGOUT = 30 * 1000; // 30 seconds
const warningBox = document.getElementById("warningBox");
const countdownEl = document.getElementById("countdown");

function sendPing() {
    const now = Date.now();
    if (now - lastPing < 10000) return; 
    lastPing = now;
    fetch("/ping").catch(() => {});
}

function resetTimers() {
    clearTimeout(pingTimeout);
    clearTimeout(logoutTimer);
    clearTimeout(warningTimer);
    clearInterval(countdownTimer);

    warningBox.style.display = "none"; // üü° hide warning if active again

    sendPing();
    pingTimeout = setTimeout(sendPing, 60 * 1000);

    // Show warning 30s before logout
    warningTimer = setTimeout(() => {
        let remaining = 30;
        warningBox.style.display = "block";
        countdownEl.textContent = remaining;

        countdownTimer = setInterval(() => {
            remaining--;
            countdownEl.textContent = remaining;
            if (remaining <= 0) {
                clearInterval(countdownTimer);
            }
        }, 1000);
    }, INACTIVITY_LIMIT - WARNING_BEFORE_LOGOUT);

    // Auto logout
    logoutTimer = setTimeout(() => {
        fetch("/logout", { method: "POST" })
          .then(() => window.location.href = "/");
    }, INACTIVITY_LIMIT);
}

// Events
["mousemove", "keydown", "scroll", "click", "touchstart"].forEach(evt => {
    document.addEventListener(evt, resetTimers);
});

window.addEventListener("pageshow", sendPing);
window.addEventListener("beforeunload", sendPing);

resetTimers();
</script>
</body></html>