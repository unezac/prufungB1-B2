<html lang="de"><head>
<meta charset="utf-8"/>
<title>Lesen Teil 3</title>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<!-- Font Awesome for Icons -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
<style>
    :root {
      --primary-color: #3498db; /* A slightly more vibrant blue */
      --secondary-color: #2ecc71; /* Green for success */
      --danger-color: #e74c3c; /* Red for error */
      --light-bg: #ecf0f1;
      --dark-text: #2c3e50;
      --light-text: #ffffff;
      --border-radius: 10px;
      --box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      --box-shadow-hover: 0 8px 20px rgba(0,0,0,0.15);
    }

    body {
      font-family: 'Segoe UI', 'Roboto', Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      color: var(--dark-text);
      animation: fadeInPage 0.8s ease-out;
      min-height: 100vh;
      box-sizing: border-box;
    }

    @keyframes fadeInPage {
      from { opacity: 0; transform: translateY(-15px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .header {
      background-color: var(--primary-color);
      color: var(--light-text);
      padding: 20px 25px;
      margin-bottom: 25px;
      border-radius: var(--border-radius);
      text-align: center;
      font-size: 26px;
      font-weight: 600;
      box-shadow: var(--box-shadow);
      letter-spacing: 0.5px;
    }

    .container {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    @media(min-width: 768px) {
      .container {
        flex-direction: row;
      }
    }

    .left-column, .right-column {
      flex: 1;
      min-width: 300px;
    }

    .quiz-scroll-container, .right-column-content {
      background-color: var(--light-text);
      border-radius: var(--border-radius);
      padding: 15px;
      box-shadow: var(--box-shadow);
      max-height: 60vh; /* Adjusted for better viewport fit */
      overflow-y: auto;
      /* Custom scrollbar styling */
      scrollbar-width: thin;
      scrollbar-color: var(--primary-color) var(--light-bg);
    }

    /* Style for .right-column-content when being dragged over */
    .right-column-content.drag-over {
        background-color: #eef8ff; /* Same as .drop-target.drag-over */
        border: 2px dashed var(--primary-color); /* Add a border to indicate it's a drop zone */
    }


    .quiz-scroll-container::-webkit-scrollbar,
    .right-column-content::-webkit-scrollbar {
      width: 8px;
    }
    .quiz-scroll-container::-webkit-scrollbar-track,
    .right-column-content::-webkit-scrollbar-track {
      background: var(--light-bg);
      border-radius: var(--border-radius);
    }
    .quiz-scroll-container::-webkit-scrollbar-thumb,
    .right-column-content::-webkit-scrollbar-thumb {
      background-color: var(--primary-color);
      border-radius: var(--border-radius);
      border: 2px solid var(--light-bg);
    }


    .question-box {
      border: 1px solid #bdc3c7;
      border-left: 5px solid var(--primary-color);
      border-radius: var(--border-radius);
      margin-bottom: 20px;
      padding: 15px;
      background-color: #fdfdfd; /* Slightly off-white */
      transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
    }
    .question-box:hover {
      transform: translateY(-3px);
      box-shadow: var(--box-shadow-hover);
    }
    .question-text {
      font-size: 0.9em;
      color: #7f8c8d;
      margin-top: 10px;
    }

    .drop-target {
      background-color: #f9f9f9;
      padding: 12px;
      margin-bottom: 10px; /* Space between drop target and question text */
      border: 2px dashed #cccccc;
      min-height: 45px;
      border-radius: 8px;
      text-align: center;
      transition: background-color 0.3s, border-color 0.3s;
      display: flex; /* To center placeholder and dropped item */
      align-items: center;
      justify-content: center;
      position: relative; /* For feedback icons */
    }
    .drop-target.empty-drop-target::before {
      content: "Hier Antwort ablegen";
      color: #aaa;
      font-style: italic;
      font-size: 0.9em;
    }
    .drop-target:not(.empty-drop-target)::before {
      content: ""; /* Clear placeholder when not empty */
    }

    .drop-target:hover, .drop-target.drag-over {
      background-color: #eef8ff;
      border-color: var(--primary-color);
    }

    .draggable {
      background-color: #e0e0e0;
      color: var(--dark-text);
      margin: 10px 0;
      padding: 12px 15px;
      border-radius: 8px;
      cursor: grab;
      display: flex;
      align-items: center;
      transition: background-color 0.3s, transform 0.2s, box-shadow 0.2s;
      user-select: none;
      font-size: 0.95em;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    .draggable:hover {
      background-color: #d0d0d0;
      transform: translateX(3px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    .draggable.selected {
      outline: 2px solid var(--primary-color);
      box-shadow: 0 0 0 3px var(--primary-color_alpha, rgba(52, 152, 219, 0.3));
      background-color: #cce7ff;
    }
    .draggable.dragging {
      opacity: 0.6;
      transform: scale(0.95);
      box-shadow: 0 10px 20px rgba(0,0,0,0.2);
      cursor: grabbing;
    }

    /* Feedback styling for drop targets */
    .drop-target.correct {
      background-color: #e8f5e9; /* Light green */
      border: 2px solid var(--secondary-color) !important;
    }
    .drop-target.correct::after {
      content: "\f00c"; /* Font Awesome check icon */
      font-family: "Font Awesome 6 Free";
      font-weight: 900;
      color: var(--secondary-color);
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 1.2em;
    }

    .drop-target.incorrect {
      background-color: #ffebee; /* Light red */
      border: 2px solid var(--danger-color) !important;
    }
    .drop-target.incorrect::after {
      content: "\f00d"; /* Font Awesome times icon */
      font-family: "Font Awesome 6 Free";
      font-weight: 900;
      color: var(--danger-color);
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 1.2em;
    }
    /* Ensure dropped draggable text is visible over feedback */
    .drop-target .draggable {
      background-color: var(--primary-color);
      color: var(--light-text);
      width: calc(100% - 30px); /* Adjust width to make space for icon */
      padding-right: 35px; /* Space for the potential icon */
      box-sizing: border-box;
    }
    .drop-target.correct .draggable { background-color: var(--secondary-color); }
    .drop-target.incorrect .draggable { background-color: var(--danger-color); }


    .wrong-flag {
      margin-right: 10px;
      accent-color: var(--danger-color);
      transform: scale(1.2);
      cursor: pointer;
    }

    .button-container {
      margin-top: 25px;
      display: flex;
      justify-content: center;
      gap: 15px;
      flex-wrap: wrap;
    }

    .quiz-button {
      padding: 12px 25px;
      border: none;
      background-color: var(--primary-color);
      color: white;
      font-size: 16px;
      font-weight: 500;
      border-radius: var(--border-radius);
      cursor: pointer;
      transition: background-color 0.3s, transform 0.2s, box-shadow 0.2s;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      box-shadow: var(--box-shadow);
    }
    .quiz-button:hover {
      background-color: #2980b9; /* Darker shade of primary */
      transform: translateY(-2px);
      box-shadow: var(--box-shadow-hover);
    }
    .quiz-button:active {
      transform: translateY(0px);
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .quiz-button.secondary {
      background-color: #7f8c8d; /* A neutral secondary color */
    }
    .quiz-button.secondary:hover {
      background-color: #6c7a89;
    }

    #result {
      text-align: center;
      margin-top: 25px;
      padding: 15px;
      font-size: 1.1em;
      font-weight: 500;
      background-color: var(--light-text);
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
    }
    #result .correct-count { color: var(--secondary-color); }
    #result .total-count { color: var(--primary-color); }
    #result .marked-wrong-count { color: var(--danger-color); }

    #warningBox {
  display: none;
  position: fixed;
  top: 20px;                  
  left: 50%;                  
  transform: translateX(-50%);
  background: #f81d1d;
  color: #ffffff;
  padding: 15px 20px;
  border-radius: 10px;
  box-shadow: 0 0 10px rgba(0,0,0,0.3);
  font-family: Arial, sans-serif;
  font-size: 14px;
  font-weight: bold;
  z-index: 9999;
}

  </style>
</head>
<body>
<div class="header">Lesen Teil 3: Sport ist Gesund</div>
<div class="container">
<div class="left-column">
<div class="quiz-scroll-container">
<!-- Questions -->
<div class="question-box" data-correct="Eine Bekannte m√∂chte ihr √§u√üeres Erscheinungsbild optimieren.">
<div class="drop-target empty-drop-target" onclick="clickDrop(this)" ondragover="allowDrop(event)" ondrop="drop(event)"></div>
<div class="question-text">
          Die Nachfrage nach individueller Farb- und Stilberatung ist gro√ü. Denn wer heute im Gesch√§fts- wie auch im Privatleben erfolgreich sein mochte, muss sich in Outfit und Benehmen vorteilhaft pr√§sentieren k√∂nnen. Der Leitfaden zeigt Ihnen, wie Sie sich selbst am besten in Szene setzen. Von der passenden und farblich stimmigen Garderobe √ºber Make-up und Accessoires bis zu modernen Umgangsformen. Nutzen Sie also diesen "Kurs" als Eintrittskarte in diese reizvolle Welt der Selbstdarstellung. Sie werden garantiert mit einem √ºberzeugenden und gewinnenden pers√∂nlichen Auftritt davon profitieren.
        </div>
</div>
<div class="question-box" data-correct="Eine Studentin sucht Informationen, wie sie besser und systematischer lernen kann.">
<div class="drop-target empty-drop-target" onclick="clickDrop(this)" ondragover="allowDrop(event)" ondrop="drop(event)"></div>
<div class="question-text">
          Die meisten Menschen kennen keine Strategien, wie sie ihr Lernverhalten und die F√§higkeit, sich Informationen zu merken, gezielt trainieren k√∂nnen. Dieses Buch gibt zun√§chst einen √úberblick, wie das menschliche Ged√§chtnis funktioniert, und bietet dann eine F√ºlle von Techniken an, mit denen auch Unge√ºbte sich das Lernen und Arbeiten leichter machen k√∂nnen.
        </div>
</div>
<!-- THIS QUESTION HAS NO CORRECT ANSWER -->
<div class="question-box" data-correct="Ein Bekannter schreibt an einer Hausarbeit √ºber gesellschaftliche Normen und Verhaltensregeln verschiedener Jahrhunderte.">
<div class="drop-target empty-drop-target" onclick="clickDrop(this)" ondragover="allowDrop(event)" ondrop="drop(event)"></div>
<div class="question-text">
            Dieses erstmals 1788 erschienene Buch handelt von dem Umgang der Menschen miteinander und gibt Ratschl√§ge. wie man sich im Umgang mit Menschen verschiedenster Alters- und Rangstufen richtig verh√§lt. Es definiert, was Gutes und was schlechtes Verhalten ist, und galt so lange Zeit als ein Leitfaden f√ºr "richtiges" Benehmen.
        </div>
</div>
<div class="question-box" data-correct="Eine Bekannte interessiert sich f√ºr B√ºcher √ºber den Tennissport.">
<div class="drop-target empty-drop-target" onclick="clickDrop(this)" ondragover="allowDrop(event)" ondrop="drop(event)"></div>
<div class="question-text">
            Tim Gallwey entwickelte die Theorie vom Tennis-Spiel, das sich im Kopf abspielt. Er zeigt, wie jeder sein Leben frei von Angst und mit Eleganz spielen kann, ohne in Selbstzweifel oder Unkonzentriertheit zu verfallen. Das Gallwey'sche Tennisspiel setzt ungeahnte Energien frei und zeigt das grenzenlose Potential des menschlichen K√∂rpers und Geistes, wenn es darum geht, seine Lebensziele zu verfolgen und zu erreichen.
        </div>
</div>
<div class="question-box" data-correct="Eine Bekannte ist sehr verunsichert, weil sie auf Konferenzen immer wieder Angst hat, frei zu sprechen.">
<div class="drop-target empty-drop-target" onclick="clickDrop(this)" ondragover="allowDrop(event)" ondrop="drop(event)"></div>
<div class="question-text">
            Jeder Mensch kann seine kommunikativen M√∂glichkeiten entdecken und damit sein Leben bereichern. Die Themen des Buches sind: Die Grundlagen der Kommunikation, Rede und Vortrag, Gespr√§che erfolgreich f√ºhren, Sicherheit gewinnen und Rede√§ngste √ºberwinden, Zeitmanagement f√ºr Redner und Konferenzleiter und vieles mehr. Ein ausf√ºhrlicher Praxisteil mit zahlreichen √úbungen erm√∂glicht es dem Leser, seine rhetorischen F√§higkeiten zu trainieren.
        </div>
</div>
<div class="question-box" data-correct="__NO_CORRECT_ANSWER__">
<div class="drop-target empty-drop-target" onclick="clickDrop(this)" ondragover="allowDrop(event)" ondrop="drop(event)"></div>
<div class="question-text">
            Gute Umgangsformen sind wieder "in". Aber gilt das auch in der Schule? Auf humorvolle Weise erz√§hlt die Autorin aus ihrem Alltag als Lehrerin an einer Realschule. Von gutem Benehmen kann da nicht immer die Rede sein - √ºbrigens auch nicht bei den Eltern.
        </div>
</div>
<!-- THIS QUESTION HAS NO CORRECT ANSWER -->
<div class="question-box" data-correct="__NO_CORRECT_ANSWER__">
<div class="drop-target empty-drop-target" onclick="clickDrop(this)" ondragover="allowDrop(event)" ondrop="drop(event)"></div>
<div class="question-text">
<h4>Frieder Schulze "Reden wir miteinander oder aneinander vorbei?"</h4>
          Manche Missverst√§ndnisse entstehen, wenn Menschen miteinander reden, besonders im privaten Bereich erleben wir das oft. Wenn Kommunikation erfolgreich sein soll, ist die F√§higkeit erforderlich, den anderen zu durchschauen und seelische Vorg√§nge und menschliche Probleme 71] erkennen. Viele Beispiele zeigen, wie psychologische Aspekte menschliche Kommunikation verkomplizieren k√∂nnen und wie man damit am besten klarkommen kann.
        </div>
</div>
<div class="question-box" data-correct="Ein Bekannter m√∂chte wissen, welche Botschaften durch Gestik und Mimik transportiert werden.">
<div class="drop-target empty-drop-target" onclick="clickDrop(this)" ondragover="allowDrop(event)" ondrop="drop(event)"></div>
<div class="question-text">
<h4>Ken Best "Dein K√∂rper lugt nicht"</h4>
          Der K√∂rper l√ºgt nicht, Gesten und Geb√§rden decken die Ebene des Unbewusstseins auf: Wer einen erhobenen Zeigefinger oder eine ger√ºmpfte Nase sieht, versteht sofort, was der Gespr√§chspartner meint, auch wenn der mit Worten etwas anderes sagt. Dieses Buch gibt einen anschaulichen √úberblick √ºber die Signale, die wir st√§ndig mit unserem K√∂rper senden, und hilft uns zu verstehen, was jemand in Wahrheit gerade denkt und meint.
        </div>
</div>
<div class="question-box" data-correct="Ein Bekannter ist sich noch unsicher, wie er sich bei einem Vorstellungsgespr√§ch am besten pr√§sentiert.">
<div class="drop-target empty-drop-target" onclick="clickDrop(this)" ondragover="allowDrop(event)" ondrop="drop(event)"></div>
<div class="question-text">
<h4>Rolph Barth "Basiswissen: Bewerbungstraining" </h4>
          Die Konkurrenz auf dem Arbeitsmarkt um immer knapper werdende freie Stellen ist gro√ü. Umso wichtiger ist es zu wissen, wie man sich richtig bewirbt. Dieses Buch gibt Arbeitsuchenden umfassende Informationen zur erfolgreichen Bewerbung und bereitet optimal auf das Vorstellungsgespr√§ch vor. Im √úbungsteil werden gute Formulierungen f√ºr das Anschreiben und das sichere Auftreten des Bewerbers im Gespr√§ch trainiert.
        </div>
</div>
<!-- THIS QUESTION HAS NO CORRECT ANSWER -->
<div class="question-box" data-correct="__NO_CORRECT_ANSWER__">
<div class="drop-target empty-drop-target" onclick="clickDrop(this)" ondragover="allowDrop(event)" ondrop="drop(event)"></div>
<div class="question-text">
<h4>Brigitte H√ºbner "Richtig pr√§sentieren"</h4>
          Dieses Buch ist ein Leitfaden f√ºr alle, die Teamsitzungen, Besprechungen, Workshops und Konferenzen durchf√ºhren. Anhand vieler praktischer Beispiele erh√§lt der Leser Anregungen zum gekonnten visualisieren, zur gut geplanten und sicher durchgef√ºhrten Pr√§sentation und zur effektiv gestalteten Besprechung. Es zeigt, wie durch den Einsatz von Bildern und Grafiken Pr√§sentationen aufgelockert und Informationen besser verstanden werden k√∂nnen.
        </div>
</div>
<div class="question-box" data-correct="__NO_CORRECT_ANSWER__">
<div class="drop-target empty-drop-target" onclick="clickDrop(this)" ondragover="allowDrop(event)" ondrop="drop(event)"></div>
<div class="question-text">
<h4>Helga Sinn-Krummacher "Delfin oder Delphin? So schreibt man das jetzt richtig"</h4>
          Dieses Trainingsbuch ist f√ºr den Arbeitsplatz und f√ºr zu Hause gedacht. Auf humorvolle Art werden die neuen Rechtschreibregeln der deutschen Sprache vorgestellt und einge√ºbt. Es enth√§lt au√üerdem die neue amtliche Wortliste zur Rechtschreibung und die neuen Zeichensetzungsregeln.
        </div>
</div>
<div class="question-box" data-correct="Ein befreundetes Ehepaar steht andauernd unter Stress und m√∂chte wieder mehr Zeit f√ºr sich und andere haben.">
<div class="drop-target empty-drop-target" onclick="clickDrop(this)" ondragover="allowDrop(event)" ondrop="drop(event)"></div>
<div class="question-text">
<h4>Erika Tack "Zeitmanagement"</h4>
          Viele Menschen wissen nicht mehr, wo Ihnen der Kopf steht. Zu viele Termine und Aufgaben stellen Sie unter st√§ndigen Zeitdruck. Mit Zeitmanagement lernen Sie, wie Sie Ihre Zeit so einteilen k√∂nnen, dass Sie wieder Zeit zum Leben haben. Sie erkennen Ihre pers√∂nlichen Zeitdiebe, Sie lernen, Priorit√§ten und erreichbare Ziele zu setzen. Durch das F√ºhren eines Zeitplanbuchs lernen Sie wieder (und dauerhaft), aus der Zeitfalle herauszukommen.
        </div>
</div>
</div>
</div>
<div class="right-column">
<!-- MODIFIED: Added ondragover and ondrop to make this a droppable area -->
<div class="right-column-content" onclick="clearSelected()" ondragover="allowDrop(event)" ondrop="dropOnAnswersContainer(event)">
<!-- Answers -->
<div class="draggable" draggable="true" id="a1" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
<input class="wrong-flag" onclick="event.stopPropagation()" type="checkbox"/> Eine Bekannte interessiert sich f√ºr B√ºcher √ºber den Tennissport.
      </div>
<div class="draggable" draggable="true" id="a2" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
<input class="wrong-flag" onclick="event.stopPropagation()" type="checkbox"/> Ein befreundetes Ehepaar steht andauernd unter Stress und m√∂chte wieder mehr Zeit f√ºr sich und andere haben.
      </div>
<div class="draggable" draggable="true" id="a3" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
<input class="wrong-flag" onclick="event.stopPropagation()" type="checkbox"/> Eine Bekannte m√∂chte bei ihren Partys eine perfekte Gastgeberin sein.
      </div>
<div class="draggable" draggable="true" id="a4" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
<input class="wrong-flag" onclick="event.stopPropagation()" type="checkbox"/> Eine Studentin sucht Informationen, wie sie besser und systematischer lernen kann.
      </div>
<div class="draggable" draggable="true" id="a5" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
<input class="wrong-flag" onclick="event.stopPropagation()" type="checkbox"/> Ein Bekannter m√∂chte wissen, welche Botschaften durch Gestik und Mimik transportiert werden.
      </div>
<div class="draggable" draggable="true" id="a6" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
<input class="wrong-flag" onclick="event.stopPropagation()" type="checkbox"/> Eine Bekannte m√∂chte ihr √§u√üeres Erscheinungsbild optimieren.
      </div>
<div class="draggable" draggable="true" id="a7" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
<input class="wrong-flag" onclick="event.stopPropagation()" type="checkbox"/> Ein Bekannter ist sich noch unsicher, wie er sich bei einem Vorstellungsgespr√§ch am besten pr√§sentiert.
      </div>
<div class="draggable" draggable="true" id="a8" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
<input class="wrong-flag" onclick="event.stopPropagation()" type="checkbox"/> Ein Bekannter schreibt an einer Hausarbeit √ºber gesellschaftliche Normen und Verhaltensregeln verschiedener Jahrhunderte.
      </div>
<div class="draggable" draggable="true" id="a9" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
<input class="wrong-flag" onclick="event.stopPropagation()" type="checkbox"/> Ein Bekannter m√∂chte Kalligraphie (Schmuckschriften) lernen.
      </div>
<div class="draggable" draggable="true" id="a10" onclick="selectAnswer(this, event)" ondragstart="drag(event)">
<input class="wrong-flag" onclick="event.stopPropagation()" type="checkbox"/> Eine Bekannte ist sehr verunsichert, weil sie auf Konferenzen immer wieder Angst hat, frei zu sprechen.
      </div>
</div>
</div>
</div>
<div class="button-container">
<button class="quiz-button" id="submitQuizButton">
<i class="fas fa-paper-plane"></i> Abschicken
    </button>
<button class="quiz-button secondary" id="resetQuizButton">
<i class="fas fa-redo"></i> Zur√ºcksetzen
    </button>
<!-- Changed to <a> tag for navigation, href to a generic "index.html" or "#" -->
<a class="quiz-button secondary" href="/index2" id="homeButton" role="button">
<i class="fas fa-home"></i> Startseite
    </a>
</div>
<div id="result"></div>
<script>
  let selectedAnswer = null;
  const rightColumnContent = document.querySelector(".right-column-content");
  const originalAnswerOrder = Array.from(rightColumnContent.querySelectorAll('.draggable')); // Store initial order for reset

  // MODIFIED: allowDrop to correctly identify parent droppable container
  function allowDrop(ev) {
    ev.preventDefault();
    let droppableContainer = ev.target;
    // Traverse up to find the actual droppable container (.drop-target or .right-column-content)
    while (droppableContainer && droppableContainer !== document.body &&
           !droppableContainer.classList.contains("drop-target") &&
           !droppableContainer.classList.contains("right-column-content")) {
        droppableContainer = droppableContainer.parentElement;
    }

    if (droppableContainer && (droppableContainer.classList.contains("drop-target") || droppableContainer.classList.contains("right-column-content"))) {
        droppableContainer.classList.add("drag-over");
    }
  }

  function drag(ev) {
    ev.dataTransfer.setData("text", ev.target.id);
    ev.target.classList.add("dragging");
    // Store the original parent in case the drag is to another drop-target
    // This can be complex if not dropped successfully; let's manage parentage in drop handlers
  }

  // MODIFIED: Original document 'dragleave' listener is kept, but dragend cleanup is more robust.
  document.addEventListener('dragleave', function(event) {
    // This simple version only removes drag-over if event.target is the droppable itself.
    // More complex logic (checking event.relatedTarget) is needed for perfect behavior
    // when dragging over children, but dragend cleanup will handle most cases.
    if (event.target.classList && (event.target.classList.contains("drop-target") || event.target.classList.contains("right-column-content"))) {
        // A basic check: if relatedTarget is outside this element, remove drag-over
        if (!event.target.contains(event.relatedTarget) && event.target !== event.relatedTarget) {
             event.target.classList.remove("drag-over");
        } else if (event.relatedTarget === null) { // Mouse left the window
            event.target.classList.remove("drag-over");
        }
    }
  }, false);
  
  // MODIFIED: dragend to clean up all drag-over classes
  document.addEventListener('dragend', function(event) {
    if (event.target.classList && event.target.classList.contains('draggable')) {
      event.target.classList.remove('dragging');
    }
    // Global cleanup for any remaining drag-over states
    document.querySelectorAll('.drop-target.drag-over, .right-column-content.drag-over').forEach(el => {
        el.classList.remove('drag-over');
    });
  });

  // MODIFIED: drop function for question slots
  function drop(ev) {
    ev.preventDefault();
    const draggedId = ev.dataTransfer.getData("text");
    const draggedEl = document.getElementById(draggedId);
    let dropTarget = ev.target;

    while (dropTarget && !dropTarget.classList.contains("drop-target")) {
        dropTarget = dropTarget.parentElement;
    }
    
    if (!dropTarget || !draggedEl) return;

    dropTarget.classList.remove("drag-over");
    // draggedEl.classList.remove("dragging"); // Done by dragend

    const originalParentOfDraggedEl = draggedEl.parentElement; // Capture before moving

    const currentAnswerInTarget = dropTarget.querySelector(".draggable");
    if (currentAnswerInTarget && currentAnswerInTarget !== draggedEl) {
      rightColumnContent.appendChild(currentAnswerInTarget);
      showCheckbox(currentAnswerInTarget);
      // The targetDropzone (parent of currentAnswerInTarget) will be updated by updateDropTargetState(dropTarget)
    }
    
    dropTarget.innerHTML = ""; // Clear previous content
    dropTarget.appendChild(draggedEl);
    hideCheckbox(draggedEl);
    updateDropTargetState(dropTarget);

    // If the dragged element came from a *different* drop-target, update that one too.
    if (originalParentOfDraggedEl &&
        originalParentOfDraggedEl.classList.contains("drop-target") &&
        originalParentOfDraggedEl !== dropTarget) {
        updateDropTargetState(originalParentOfDraggedEl);
    }

    if (selectedAnswer === draggedEl) {
        draggedEl.classList.remove("selected");
        selectedAnswer = null;
    }
  }

  // NEW: Function to handle drops onto the answers container
  function dropOnAnswersContainer(ev) {
    ev.preventDefault();
    const draggedId = ev.dataTransfer.getData("text");
    const draggedEl = document.getElementById(draggedId);
    const answersContainer = ev.currentTarget; // This is right-column-content

    if (!draggedEl || !answersContainer) return;

    answersContainer.classList.remove("drag-over");
    // draggedEl.classList.remove("dragging"); // Done by dragend

    const originalParentOfDraggedEl = draggedEl.parentElement; // Capture before moving

    answersContainer.appendChild(draggedEl);
    showCheckbox(draggedEl);

    // If the dragged element came from a question's drop-target, update that drop-target's state
    if (originalParentOfDraggedEl && originalParentOfDraggedEl.classList.contains("drop-target")) {
        updateDropTargetState(originalParentOfDraggedEl);
    }

    if (selectedAnswer === draggedEl) {
        draggedEl.classList.remove("selected");
        selectedAnswer = null;
    }
  }


  function hideCheckbox(el) {
    const checkbox = el.querySelector(".wrong-flag");
    if (checkbox) checkbox.style.display = "none";
  }

  function showCheckbox(el) {
    const checkbox = el.querySelector(".wrong-flag");
    if (checkbox) checkbox.style.display = "inline-block";
  }

  function selectAnswer(el, event) {
    event.stopPropagation(); 
    if (selectedAnswer === el) { 
      el.classList.remove("selected");
      selectedAnswer = null;
    } else {
      if (selectedAnswer) selectedAnswer.classList.remove("selected");
      selectedAnswer = el;
      el.classList.add("selected");
    }
  }

  // MODIFIED: clickDrop function
  function clickDrop(targetDropzone) {
    if (selectedAnswer) {
      const originalParentOfSelectedAnswer = selectedAnswer.parentElement; // Capture before moving

      const currentAnswerInDropzone = targetDropzone.querySelector(".draggable");
      if (currentAnswerInDropzone && currentAnswerInDropzone !== selectedAnswer) {
        rightColumnContent.appendChild(currentAnswerInDropzone);
        showCheckbox(currentAnswerInDropzone);
      }
      
      targetDropzone.innerHTML = ""; 
      targetDropzone.appendChild(selectedAnswer);
      hideCheckbox(selectedAnswer);
      updateDropTargetState(targetDropzone);

      // If selectedAnswer came from a *different* drop-target, update that one.
      if (originalParentOfSelectedAnswer &&
          originalParentOfSelectedAnswer.classList.contains("drop-target") &&
          originalParentOfSelectedAnswer !== targetDropzone) {
          updateDropTargetState(originalParentOfSelectedAnswer);
      }
      // If it came from rightColumnContent, originalParentOfSelectedAnswer is rightColumnContent, no UI update needed for it.

      selectedAnswer.classList.remove("selected");
      selectedAnswer = null;
    }
  }

  function clearSelected() {
    if (selectedAnswer) {
      selectedAnswer.classList.remove("selected");
      selectedAnswer = null;
    }
  }

  function updateDropTargetState(dropTarget) {
    if (!dropTarget || !dropTarget.classList.contains('drop-target')) return;
    
    if (dropTarget.querySelector(".draggable")) {
      dropTarget.classList.remove("empty-drop-target");
    } else {
      dropTarget.classList.add("empty-drop-target");
    }
  }

  function getDraggableText(draggableElement) {
    const clone = draggableElement.cloneNode(true);
    const checkbox = clone.querySelector('.wrong-flag');
    if (checkbox) {
        checkbox.remove();
    }
    return clone.textContent.trim();
  }

  function submitQuiz() {
    let total = 0, correct = 0;
    document.querySelectorAll('.question-box').forEach((box) => {
      total++;
      const correctAnswerText = box.getAttribute("data-correct").trim();
      const dropTarget = box.querySelector(".drop-target");
      const droppedDraggable = dropTarget.querySelector(".draggable");
      
      dropTarget.classList.remove("correct", "incorrect"); 

      if (droppedDraggable) { 
        const selectedText = getDraggableText(droppedDraggable); 
        if (correctAnswerText === "__NO_CORRECT_ANSWER__") {
          dropTarget.classList.add("incorrect");
        } else {
          if (selectedText === correctAnswerText) {
            dropTarget.classList.add("correct");
            correct++;
          } else {
            dropTarget.classList.add("incorrect");
          }
        }
      } else { 
        if (correctAnswerText !== "__NO_CORRECT_ANSWER__") {
          dropTarget.classList.add("incorrect");
        }
      }
      updateDropTargetState(dropTarget); 
    });

    let wrongMarkedCorrect = 0, wrongMarkedTotal = 0;
    rightColumnContent.querySelectorAll('.draggable').forEach((answerEl) => {
      const text = getDraggableText(answerEl); 
      const checkbox = answerEl.querySelector('.wrong-flag');
      
      const isACorrectAnswerOptionForAnyQuestion = Array.from(document.querySelectorAll('.question-box'))
        .some(box => {
            const qCorrectText = box.getAttribute('data-correct').trim();
            return qCorrectText !== "__NO_CORRECT_ANSWER__" && qCorrectText === text;
        });
      
      if (!isACorrectAnswerOptionForAnyQuestion) { 
        wrongMarkedTotal++; 
        if (checkbox.checked) {
          wrongMarkedCorrect++; 
        }
      }
    });

    const questionsWithNoAnswer = Array.from(document.querySelectorAll('.question-box'))
                                      .filter(box => box.getAttribute('data-correct').trim() === "__NO_CORRECT_ANSWER__").length;
    const scorableTotal = total - questionsWithNoAnswer;


    const resultDiv = document.getElementById("result");
    resultDiv.innerHTML =
      `<span class="correct-count">‚úÖ ${correct}</span> von <span class="total-count">${scorableTotal}</span> bewertbaren Fragen richtig. | ` + 
      `<span class="marked-wrong-count">üö´ Falsch-Antworten korrekt markiert: ${wrongMarkedCorrect}</span> von ${wrongMarkedTotal}.`;
  }

  function resetQuiz() {
    document.querySelectorAll('.drop-target').forEach(dt => {
        const draggable = dt.querySelector('.draggable');
        if (draggable) {
            // Append to ensure it's at the end if others were returned individually
            rightColumnContent.appendChild(draggable); 
            showCheckbox(draggable); 
        }
        dt.innerHTML = ''; 
        dt.classList.remove('correct', 'incorrect'); 
        updateDropTargetState(dt); 
    });

    // Clear the right column first to avoid duplicates if an item was already returned
    rightColumnContent.innerHTML = ''; 
    originalAnswerOrder.forEach(draggable => {
        rightColumnContent.appendChild(draggable); 
        draggable.classList.remove('selected', 'dragging'); 
        showCheckbox(draggable); 
        const checkbox = draggable.querySelector('.wrong-flag');
        if (checkbox) checkbox.checked = false; 
    });
    
    if (selectedAnswer) {
      selectedAnswer.classList.remove('selected');
      selectedAnswer = null;
    }

    document.getElementById("result").innerHTML = ""; 
  }

  document.getElementById('submitQuizButton').addEventListener('click', submitQuiz);
  document.getElementById('resetQuizButton').addEventListener('click', resetQuiz);

  document.querySelectorAll('.drop-target').forEach(updateDropTargetState);
</script>
<script>
let pingTimeout;
let logoutTimer;
let warningTimer;
let countdownTimer;
let lastPing = 0;

const INACTIVITY_LIMIT = 15 * 60 * 1000; // 15 minutes
const WARNING_BEFORE_LOGOUT = 30 * 1000; // 30 seconds
const warningBox = document.getElementById("warningBox");
const countdownEl = document.getElementById("countdown");

function sendPing() {
    const now = Date.now();
    if (now - lastPing < 10000) return; 
    lastPing = now;
    fetch("/ping").catch(() => {});
}

function resetTimers() {
    clearTimeout(pingTimeout);
    clearTimeout(logoutTimer);
    clearTimeout(warningTimer);
    clearInterval(countdownTimer);

    warningBox.style.display = "none"; // üü° hide warning if active again

    sendPing();
    pingTimeout = setTimeout(sendPing, 60 * 1000);

    // Show warning 30s before logout
    warningTimer = setTimeout(() => {
        let remaining = 30;
        warningBox.style.display = "block";
        countdownEl.textContent = remaining;

        countdownTimer = setInterval(() => {
            remaining--;
            countdownEl.textContent = remaining;
            if (remaining <= 0) {
                clearInterval(countdownTimer);
            }
        }, 1000);
    }, INACTIVITY_LIMIT - WARNING_BEFORE_LOGOUT);

    // Auto logout
    logoutTimer = setTimeout(() => {
        fetch("/logout", { method: "POST" })
          .then(() => window.location.href = "/");
    }, INACTIVITY_LIMIT);
}

// Events
["mousemove", "keydown", "scroll", "click", "touchstart"].forEach(evt => {
    document.addEventListener(evt, resetTimers);
});

window.addEventListener("pageshow", sendPing);
window.addEventListener("beforeunload", sendPing);

resetTimers();
</script>
</body></html>