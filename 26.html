<html lang="de"><head>
<meta charset="utf-8"/>
<title>Lesen Teil 1 - Grundschule</title>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
<style>
    :root {
      --primary-color: #3498db;
      --secondary-color: #2ecc71;
      --danger-color: #e74c3c;
      --light-bg: #ecf0f1;
      --dark-text: #2c3e50;
      --light-text: #ffffff;
      --border-radius: 10px;
      --box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      --box-shadow-hover: 0 8px 20px rgba(0,0,0,0.15);
    }
    *, *::before, *::after { box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', 'Roboto', Arial, sans-serif; margin: 0; padding: 10px;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); color: var(--dark-text);
      animation: fadeInPage 0.8s ease-out; min-height: 100vh;
    }
    @media (min-width: 600px) { body { padding: 15px; } }
    @media (min-width: 992px) { body { padding: 20px; } }
    @keyframes fadeInPage { from { opacity: 0; transform: translateY(-15px); } to { opacity: 1; transform: translateY(0); } }
    .main-header {
      background-color: var(--primary-color); color: var(--light-text); padding: 12px 15px;
      font-size: 20px; margin-bottom: 20px; border-radius: var(--border-radius);
      text-align: center; font-weight: 600; box-shadow: var(--box-shadow); letter-spacing: 0.5px;
    }
    @media (min-width: 768px) { .main-header { padding: 20px 25px; font-size: 26px; margin-bottom: 25px; } }
    .container { display: flex; flex-direction: row; justify-content: space-between; gap: 15px; }
    @media(min-width: 992px) { .container { gap: 20px; } }
    .left-column { width: 58%; flex-shrink: 0; }
    .right-column { width: 38%; flex-shrink: 0; }
    .quiz-scroll-container, .right-column-content {
      background-color: var(--light-text); border-radius: var(--border-radius); padding: 10px;
      box-shadow: var(--box-shadow); max-height: 75vh; overflow-y: auto; overflow-x: hidden;
      scrollbar-width: thin; scrollbar-color: var(--primary-color) var(--light-bg);
    }
    @media (min-width: 992px) { .quiz-scroll-container, .right-column-content { padding: 15px; max-height: 70vh; } }
    .quiz-scroll-container::-webkit-scrollbar, .right-column-content::-webkit-scrollbar { width: 6px; }
    @media (min-width: 992px) { .quiz-scroll-container::-webkit-scrollbar, .right-column-content::-webkit-scrollbar { width: 8px; } }
    .quiz-scroll-container::-webkit-scrollbar-track, .right-column-content::-webkit-scrollbar-track { background: var(--light-bg); border-radius: var(--border-radius); }
    .quiz-scroll-container::-webkit-scrollbar-thumb, .right-column-content::-webkit-scrollbar-thumb { background-color: var(--primary-color); border-radius: var(--border-radius); border: 2px solid var(--light-bg); }
    .question-box {
      border: 1px solid #bdc3c7; border-left: 4px solid var(--primary-color); border-radius: var(--border-radius);
      margin-bottom: 15px; padding: 10px; background-color: #fdfdfd;
      transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
      display: flex; flex-direction: column; min-height: 120px;
    }
    @media (min-width: 992px) { .question-box { border-left-width: 5px; margin-bottom: 20px; padding: 15px; min-height: 150px; } }
    .question-box:hover { transform: translateY(-3px); box-shadow: var(--box-shadow-hover); }
    .email-fields { margin-bottom: 8px; }
    @media (min-width: 992px) { .email-fields { margin-bottom: 10px; } }
    .drop-target {
      background-color: #f9f9f9; padding: 10px; border: 2px dashed #cccccc; min-height: 40px;
      border-radius: 6px; text-align: center; transition: background-color 0.3s, border-color 0.3s;
      display: flex; align-items: center; justify-content: center; position: relative; cursor: pointer; /* Added cursor */
    }
    @media (min-width: 992px) { .drop-target { padding: 12px; min-height: 45px; border-radius: 8px; } }
    .drop-target.empty-drop-target::before { content: "Drop here"; color: #aaa; font-style: italic; font-size: 0.8em; }
    @media (min-width: 992px) { .drop-target.empty-drop-target::before { content: "Antwort hier ablegen"; font-size: 0.9em; } }
    .drop-target:not(.empty-drop-target)::before { content: ""; }
    .drop-target:hover, .drop-target.drag-over { background-color: #eef8ff; border-color: var(--primary-color); }
    .question-text { font-size: 0.8em; color: #555; line-height: 1.5; overflow-y: auto; max-height: 200px; padding-right: 5px; }
    @media (min-width: 992px) { .question-text { font-size: 0.9em; line-height: 1.6; max-height: 300px; } }
    .draggable {
      background-color: #e0e0e0; color: var(--dark-text); margin: 8px 0; padding: 8px 10px;
      border-radius: 6px; cursor: grab; display: flex; align-items: center; justify-content: center;
      transition: background-color 0.3s, transform 0.2s, box-shadow 0.2s, outline 0.2s;
      user-select: none; font-size: 0.85em; box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      text-align: center; word-break: break-word;
    }
    @media (min-width: 992px) { .draggable { margin: 10px 0; padding: 12px 15px; border-radius: 8px; font-size: 0.95em; } }
    .draggable:hover { background-color: #d0d0d0; transform: scale(1.02); box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
    .draggable.dragging { opacity: 0.6; transform: scale(0.95); box-shadow: 0 10px 20px rgba(0,0,0,0.2); cursor: grabbing; }

    /* NEW CSS for selected draggable */
    .draggable.selected {
      outline: 3px solid var(--primary-color);
      transform: scale(1.03);
      box-shadow: 0 0 10px rgba(52, 152, 219, 0.5);
      background-color: #ddeeff;
    }
    .draggable.selected:hover {
        background-color: #cce7ff;
        transform: scale(1.03);
    }

    .drop-target.correct { background-color: #e8f5e9 !important; border: 2px solid var(--secondary-color) !important; }
    .drop-target.correct::after {
      content: "\f00c"; font-family: "Font Awesome 6 Free"; font-weight: 900; color: var(--secondary-color);
      position: absolute; right: 5px; top: 50%; transform: translateY(-50%); font-size: 1em;
    }
    @media (min-width: 992px) { .drop-target.correct::after { right: 10px; font-size: 1.2em; } }
    .drop-target.incorrect { background-color: #ffebee !important; border: 2px solid var(--danger-color) !important; }
    .drop-target.incorrect::after {
      content: "\f00d"; font-family: "Font Awesome 6 Free"; font-weight: 900; color: var(--danger-color);
      position: absolute; right: 5px; top: 50%; transform: translateY(-50%); font-size: 1em;
    }
    @media (min-width: 992px) { .drop-target.incorrect::after { right: 10px; font-size: 1.2em; } }
    .drop-target .draggable { background-color: var(--primary-color); color: var(--light-text); width: calc(100% - 25px); padding-right: 0; margin: 0; }
    @media (min-width: 992px) { .drop-target .draggable { width: calc(100% - 40px); } }
    .drop-target.correct .draggable { background-color: var(--secondary-color) !important; }
    .drop-target.incorrect .draggable { background-color: var(--danger-color) !important; }
    .button-container { margin-top: 20px; display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; }
    @media (min-width: 992px) { .button-container { margin-top: 25px; gap: 15px; } }
    .quiz-button, .quiz-button-link {
      padding: 10px 20px; border: none; background-color: var(--primary-color); color: white !important;
      font-size: 14px; font-weight: 500; border-radius: var(--border-radius); cursor: pointer;
      transition: background-color 0.3s, transform 0.2s, box-shadow 0.2s;
      display: inline-flex; align-items: center; justify-content: center; gap: 8px;
      box-shadow: var(--box-shadow); text-decoration: none;
    }
    @media (min-width: 992px) { .quiz-button, .quiz-button-link { padding: 12px 25px; font-size: 16px; } }
    .quiz-button:hover, .quiz-button-link:hover { background-color: #2980b9; transform: translateY(-2px); box-shadow: var(--box-shadow-hover); color: white !important; }
    .quiz-button:active, .quiz-button-link:active { transform: translateY(0px); box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    .quiz-button.secondary, .quiz-button-link.secondary { background-color: #7f8c8d; }
    .quiz-button.secondary:hover, .quiz-button-link.secondary:hover { background-color: #6c7a89; }
    #result {
      text-align: center; margin-top: 20px; padding: 12px; font-size: 1em; font-weight: 500;
      background-color: var(--light-text); border-radius: var(--border-radius); box-shadow: var(--box-shadow);
    }
    @media (min-width: 992px) { #result { margin-top: 25px; padding: 15px; font-size: 1.1em; } }
    #result .correct-count { color: var(--secondary-color); }
    #result .total-count { color: var(--primary-color); }

    #warningBox {
  display: none;
  position: fixed;
  top: 20px;                  
  left: 50%;                  
  transform: translateX(-50%);
  background: #f81d1d;
  color: #ffffff;
  padding: 15px 20px;
  border-radius: 10px;
  box-shadow: 0 0 10px rgba(0,0,0,0.3);
  font-family: Arial, sans-serif;
  font-size: 14px;
  font-weight: bold;
  z-index: 9999;
}
  </style>
</head>
<body>
<div class="main-header">Lesen Teil 1 - Grundschule</div>
<div class="container">
<div class="left-column">
<div class="quiz-scroll-container">
<!-- Question 1 -->
<div class="question-box" data-correct="Gewerkschaft erwartet Lehrermangel in Berlin.">
<div class="email-fields">
<div class="email-subject drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)"></div>
</div>
<div class="question-text">
          Berlin wird in 10 Jahren rund 5.000 Lehrkr√§fte weniger brauchen als derzeit. F√ºr den Unterricht an den Schulen werden dann, wie die Gewerkschaft Erziehung und Wissenschaft (GEW) errechnet hat, noch etwa 25.500 von heute 30.000 P√§dagogen ben√∂tigt.
          Die Gewerkschaft bef√ºrchtet zugleich, dass bis zu diesem Zeitpunkt zu wenig Nachwuchskr√§fte ausgebildet werden und es deshalb zu einer dramatischen Unterversorgung kommt. Nach Meinung der GEW steuert die Hauptstadt bei der Personalausstattung der Schulen auf ein Fiasko zu, weil in den n√§chsten 10 Jahren mehr als 10.000 Lehrkr√§fte aus Altersgr√ºnden in den Ruhestand gehen. Au√üerdem w√ºrden j√§hrlich zirka 400 Lehrer die Berliner Schulen verlassen, so dass nach Ansicht der GEW letztlich 9.000 Stellen fehlen. Wenn die Zahl der Studienanf√§nger nicht kr√§ftig gesteigert werde, k√∂nne langfristig nicht einmal die H√§lfte des prognostizierten Einstellungsbedarf gedeckt werden. Au√üerdem sei die Hauptstadt f√ºr Berufseinsteiger nicht so attraktiv wie andere Bundesl√§nder, da sie selbst f√ºr Mangelf√§cher nur befristete Vertr√§ge anbietet.
          </div>
</div>
<!-- Question 2 -->
<div class="question-box" data-correct="GEW bef√ºrchtet Abwanderung von gut ausgebildeten Lehrkr√§ften aus Berlin.">
<div class="email-fields">
<div class="email-subject drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)"></div>
</div>
<div class="question-text">
          Wer sich in Berlin um eine Stelle als Lehrer bewirbt, muss hart im Nehmen sein. ‚ÄúW√§hrend man in Hamburg respektvoll behandelt wird, rechnen Vertreter der Berliner Schulverwaltung den Bewerbern vor, wie teuer Lehrer sind. Da f√ºhlt man sich nicht richtig gewollt‚Äù, sagt Maria Sch√ºtz. Die 27-j√§hrige geh√∂rt zu den rund 500 Referendaren, die in zwei Wochen mit ihrem Studium fertig werden. Maria Sch√ºtz, die ihr Exam mit der Note 1,5 bestanden hat und unbedingt in Berlin unterrichten wollte, hat mit ihrer Bewerbung leidvolle Erfahrungen hinter Sich. ‚ÄúW√§hrend man in Hamburg sofort eine feste Stelle im Beamtenverh√§ltnis angeboten hat, konnte mir in Berlin keiner zusagen, dass ich im n√§chsten Schuljahr gebraucht werde.‚Äù Die junge Frau hat das gute Angebot aus Hamburg einer unsicheren Zukunft in Berlin vorgezogen. F√ºr Anna Richter, Vorsitzende der Lehrergewerkschaft GEW, ist Marias Geschichte nur eine von vielen. Ihre Organisation ist besorgt dar√ºber, dass Berlin auf diese Weise viele gut qualifizierte Lehrer an andere Bundesl√§nder verlieren k√∂nnte.
        </div>
</div>
<!-- Question 3 -->
<div class="question-box" data-correct="Experten bef√ºrchten zunehmenden Lehrermangel in Deutschland.">
<div class="email-fields">
<div class="email-subject drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)"></div>
</div>
<div class="question-text">
          Die Hilferufe aus den Schulen wollen nicht verstummen: Sch√ºler klagen √ºber st√§ndigen Lehrerwechsel, Eltern √ºber Stundenausfall und Schulleiter √ºber fehlende Bewerber. Doch es k√∂nnte noch schlimmer werden. Der Verband Bildung und Erziehung (VBE) rechnet in den n√§chsten 15 Jahren mit einem "gewaltigen Lehrermangel" in Deutschland. Der Verbandsvorsitzende Ludwig Eckinger sagte am Donnerstag, er gehe f√ºr diesen Zeitraum von bis zu 400.000 Lehrern aus, die aus Altersgr√ºnden aus dem Schuldienst ausscheiden. F√ºr 100 pensionierte Lehrer k√§men jedoch nur 50 neue Kollegen. Der Lehrernotstand kommt nicht √ºberraschend, Forscher sagten ihn l√§ngst voraus. Und auch die Konferenz der Kultusminister pr√§sentierte schon vor f√ºnf Jahren beunruhigende Zahlen: Es werden an deutschen Schulen 70.000 P√§dagogen fehlen, denn fast die H√§lfte der 800.000 Lehrer geht in Pension. Deshalb fordern Experten seit langem einen bundesweiten Entwicklungspan, denn Untersuchungen des Lehrerarbeitsmarkt zeigten eher "Chaos als systematische Planung". Deutschland steuere auf Zust√§nde wie in den Niederlanden zu. Dort ist der Lehrermangel so gro√ü, dass sich Schulen gegenseitig Lehrer ausspannen.
        </div>
</div>
<!-- Question 4 -->
<div class="question-box" data-correct="Bildungsforscher: Lehrermangel wird in Deutschland nicht eintreten.">
<div class="email-fields">
<div class="email-subject drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)"></div>
</div>
<div class="question-text">
          Bildungspolitiker und Lehrervertreter wollen Abiturienten scharenweise in den Lehrerberuf locken. Sie sollen gro√üe L√ºcken schlie√üen, die durch Pensionierungen entstehen. Doch das Versprechen vom sicheren Job l√§sst sich wom√∂glich nicht einl√∂sen - es basiere auf falschen Annahmen, sagen Essener Bildungsforscher.
          Die Arbeitsgruppe Bildungsforschung/Bildungsplanung unter der Leitung des Wissenschaftlers Klaus Klemm kommt in ihrem Bericht zu einem ganz anderen Ergebnis. W√§hrend die Kultusministerkonferenz mit 70.000 fehlenden Lehrern rechnet und der Philologenverband gar mit 80.000, errechnete die Forschungsgruppe, dass es zu einer insgesamt ausgeglichenen Bilanz zwischen Nachfrage und Angebot auf dem Lehrer-Arbeitsmarkt kommen werde. Wenn sich die "Einstellungspolitik der Bundesl√§nder nicht √§ndert, d√ºrften wir sogar einen Lehrer√ºberschuss bekommen", sagte Klemm. Er warnt Abiturienten, ihre Studienentscheidung von den angeblich rosigen Aussichten f√ºr Lehrer abh√§ngig zu machen. "Die Abiturienten h√∂ren, es werden Lehrer gesucht, und schon studieren sie Germanistik f√ºrs Gymnasium. Das ist ein Fehler", sagt Klemm. Denn schon jetzt zeichne sich ab, dass es Deutsch-, Geschichts- und Fremdsprachenlehrer eher schwer haben werden.
        </div>
</div>
<!-- Question 5 -->
<div class="question-box" data-correct="An deutschen Grundschulen sind m√§nnliche Lehrkr√§fte selten.">
<div class="email-fields">
<div class="email-subject drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)"></div>
</div>
<div class="question-text">
          M√§dchen haben tendenziell bessere Noten und stellen 56 Prozent der Abiturienten. Dagegen sind zwei Drittel der Schulabbrecher und drei Viertel der Sondersch√ºler Jungen. Liegt die Ursache in der Grundschule, wo von den knapp 200.000 Lehrkr√§ften nur rund 26.000 m√§nnlich sind? An der Grundschule sind M√§nner eine Rarit√§t. Wer sich dorthin verirrt, arbeitet allein unter Frauen. Im Schuljahr 1990/1991 unterrichtete noch ein Drittel M√§nner an Grundschulen, im Schuljahr 2006/2007 liegt der Frauenanteil an den Grundschullehrern bei 86,9 Prozent, w√§hrend an weiterf√ºhrenden Schulen das Geschlechterverh√§ltnis nahezu ausgeglichen ist. Im Extremfall kann das bedeuten, dass Jungen bis zum Alter von 10 oder 12 Jahren in Krippe, Kindergarten und Grundschule ausschlie√ülich von Frauen betreut und unterrichtet werden. Auch die Familienministerin vermisst die M√§nner an den Grundschulen. "In den wichtigen fr√ºhen Jahren fehlen den Jungen m√§nnliche Vorbilder, an denen sie sich im Alltag ausrichten k√∂nnen", sagte sie in einem Interview. Das gelte gerade f√ºr Kinder mit Migrationshintergrund. Gr√ºnde daf√ºr sieht sie in der gesellschaftlichen Anerkennung des Berufs und in den Gehaltsstrukturen.</div>
</div>
</div>
</div>
<div class="right-column">
<div class="right-column-content" ondragover="allowDrop(event)" ondrop="drop(event)">
<div class="draggable" draggable="true" id="a1" ondragstart="drag(event)">An deutschen Grundschulen sind m√§nnliche Lehrkr√§fte selten.</div>
<div class="draggable" draggable="true" id="a2" ondragstart="drag(event)">Bildungsexperten warnen: Deutsche Lehrer sind schlecht ausgebildet.</div>
<div class="draggable" draggable="true" id="a3" ondragstart="drag(event)">Bildungsforscher: Lehrermangel wird in Deutschland nicht eintreten.</div>
<div class="draggable" draggable="true" id="a4" ondragstart="drag(event)">Die Zahl der m√§nnlichen Lehrkr√§fte an Grundschulen nimmt zu.</div>
<div class="draggable" draggable="true" id="a5" ondragstart="drag(event)">Experten bef√ºrchten zunehmenden Lehrermangel in Deutschland.</div>
<div class="draggable" draggable="true" id="a6" ondragstart="drag(event)">Gewerkschaft erwartet Lehrermangel in Berlin.</div>
<div class="draggable" draggable="true" id="a7" ondragstart="drag(event)">GEW bef√ºrchtet Abwanderung von gut ausgebildeten Lehrkr√§ften aus Berlin.</div>
<div class="draggable" draggable="true" id="a8" ondragstart="drag(event)">Immer mehr Berliner wandern aus.</div>
<div class="draggable" draggable="true" id="a9" ondragstart="drag(event)">Immer weniger Frauen machen ein Grundschullehrer-Studium.</div>
<div class="draggable" draggable="true" id="a10" ondragstart="drag(event)">Vorausschauende Politiker verhindern Lehrermangel in Berlin.</div>
</div>
</div>
</div>
<div class="button-container">
<button class="quiz-button" onclick="submitQuiz()">
<i class="fas fa-paper-plane"></i> Abschicken
  </button>
<button class="quiz-button secondary" onclick="resetQuiz()">
<i class="fas fa-redo"></i> Zur√ºcksetzen
  </button>
<a class="quiz-button-link secondary" href="/index2"> <!-- Replace # with your actual home link -->
<i class="fas fa-home"></i> Zur√ºck zur Startseite
  </a>
</div>
<div id="result"></div>
<script>
  const rightColumnContent = document.querySelector(".right-column .right-column-content");
  const originalAnswerOrder = Array.from(rightColumnContent.querySelectorAll('.draggable'));
  let selectedDraggable = null; // To store the currently click-selected draggable item

  // --- CLICK-TO-DROP/PICKUP LOGIC ---
  function selectItem(item) {
    if (selectedDraggable) {
      selectedDraggable.classList.remove('selected');
    }
    selectedDraggable = item;
    if (selectedDraggable) {
      selectedDraggable.classList.add('selected');
    }
  }

  function deselectItem() {
    if (selectedDraggable) {
      selectedDraggable.classList.remove('selected');
      selectedDraggable = null;
    }
  }

  function handleDraggableClicked(event) {
    const clickedItem = event.currentTarget;
    event.stopPropagation(); // Prevent click bubbling to parent elements like answer pool

    if (selectedDraggable === clickedItem) { // Clicking the already selected item
      deselectItem();
      // If it was in a target and now deselected by clicking it, move it back to pool
      if (clickedItem.parentElement.classList.contains('drop-target')) {
           const parentDropTarget = clickedItem.parentElement;
           rightColumnContent.appendChild(clickedItem);
           updateDropTargetVisualState(parentDropTarget);
           parentDropTarget.classList.remove('correct', 'incorrect'); // Clear feedback
      }
    } else { // Clicking a new item, or an unselected item in a target
      // If the clicked item is currently in a drop target, "pick it up" by moving to pool first
      if (clickedItem.parentElement.classList.contains('drop-target')) {
          const parentDropTarget = clickedItem.parentElement;
          rightColumnContent.appendChild(clickedItem); // Move to pool
          updateDropTargetVisualState(parentDropTarget);
          parentDropTarget.classList.remove('correct', 'incorrect'); // Clear feedback
      }
      selectItem(clickedItem); // Then select it (it's now in the pool)
    }
  }

  function handleDropTargetClicked(event) {
    const clickedDropTarget = event.currentTarget;
    event.stopPropagation();

    if (selectedDraggable) { // If an item is selected, try to place it here
      const existingItemInTarget = clickedDropTarget.querySelector('.draggable');
      if (existingItemInTarget && existingItemInTarget !== selectedDraggable) {
        rightColumnContent.appendChild(existingItemInTarget); // Move old item from target back to pool
        // No need to deselect existingItemInTarget here, as it wasn't the 'selectedDraggable'
      }

      clickedDropTarget.innerHTML = ''; // Clear target (removes placeholder or old item)
      clickedDropTarget.appendChild(selectedDraggable); // Place new item
      updateDropTargetVisualState(clickedDropTarget);
      clickedDropTarget.classList.remove('correct', 'incorrect'); // Clear any feedback
      deselectItem(); // Item is placed, so deselect
    } else if (!selectedDraggable && clickedDropTarget.querySelector('.draggable')) {
      // No item is selected, AND the clicked drop target HAS an item: "pick up" that item.
      const itemToPickUp = clickedDropTarget.querySelector('.draggable');
      rightColumnContent.appendChild(itemToPickUp); // Move it to the pool
      updateDropTargetVisualState(clickedDropTarget);
      clickedDropTarget.classList.remove('correct', 'incorrect'); // Clear feedback
      selectItem(itemToPickUp); // And select it (it's now in the pool)
    }
  }

  function handleAnswerPoolClicked(event) {
    // If click is on the pool itself (not a draggable within it) and an item is selected
    if (event.target === rightColumnContent && selectedDraggable) {
      // If selected item is somehow not in pool (e.g. if logic changes), ensure it is
      if (selectedDraggable.parentElement !== rightColumnContent) {
           rightColumnContent.appendChild(selectedDraggable);
      }
      // The main purpose here: clicking the pool with a selected item deselects it.
      deselectItem();
    }
  }

  function initializeClickInteractions() {
    document.querySelectorAll('.draggable').forEach(item => {
      item.addEventListener('click', handleDraggableClicked);
    });
    document.querySelectorAll('.drop-target').forEach(target => {
      target.addEventListener('click', handleDropTargetClicked);
    });
    rightColumnContent.addEventListener('click', handleAnswerPoolClicked);
  }

  // --- DRAG AND DROP LOGIC (MODIFIED) ---
  function allowDrop(ev) {
    ev.preventDefault();
    let potentialDropTarget = ev.target;
    while(potentialDropTarget && !potentialDropTarget.classList.contains('drop-target') && !potentialDropTarget.classList.contains('right-column-content')) {
        potentialDropTarget = potentialDropTarget.parentElement;
    }
    if (potentialDropTarget && potentialDropTarget.classList.contains('drop-target')) {
        potentialDropTarget.classList.add("drag-over");
    }
  }

  document.addEventListener('dragleave', function(event) {
    if (event.target.classList && event.target.classList.contains("drop-target")) {
      event.target.classList.remove("drag-over");
    }
  }, false);

  function drag(ev) {
    ev.dataTransfer.setData("text", ev.target.id);
    ev.target.classList.add("dragging");
    deselectItem(); // Deselect any click-selected item when a drag operation starts
  }

  document.addEventListener('dragend', function(event) {
    if (event.target.classList && event.target.classList.contains('draggable')) {
      event.target.classList.remove('dragging');
    }
    document.querySelectorAll('.drop-target.drag-over').forEach(dt => dt.classList.remove('drag-over'));
  });

  function drop(ev) {
    ev.preventDefault();
    const draggedId = ev.dataTransfer.getData("text");
    const draggedEl = document.getElementById(draggedId);
    let dropTargetEl = ev.target;

    if (!draggedEl) return; // Safety check

    draggedEl.classList.remove("dragging");
    document.querySelectorAll('.drop-target.drag-over').forEach(dt => dt.classList.remove('drag-over'));

    while (dropTargetEl &&
           !dropTargetEl.classList.contains("drop-target") &&
           !dropTargetEl.classList.contains("right-column-content")) {
      dropTargetEl = dropTargetEl.parentElement;
    }

    if (!dropTargetEl) return;

    if (dropTargetEl.classList.contains("drop-target")) {
      const currentAnswer = dropTargetEl.querySelector(".draggable");
      if (currentAnswer && currentAnswer !== draggedEl) {
        rightColumnContent.appendChild(currentAnswer);
        currentAnswer.classList.remove('selected'); // Ensure item moved back is not selected
      }
      dropTargetEl.innerHTML = "";
      dropTargetEl.appendChild(draggedEl);
      dropTargetEl.classList.remove("correct", "incorrect");
      updateDropTargetVisualState(dropTargetEl);
    }
    else if (dropTargetEl.classList.contains("right-column-content")) {
      const originalParent = draggedEl.parentElement; // Get parent BEFORE moving
      rightColumnContent.appendChild(draggedEl);
      if (originalParent && originalParent.classList.contains('drop-target')) {
          updateDropTargetVisualState(originalParent); // Update visual state of original drop target
          originalParent.classList.remove('correct', 'incorrect');
      }
    }
    deselectItem(); // Deselect any click-selected item after a drop operation
  }

  function updateDropTargetVisualState(dropTarget) {
    if (!dropTarget || !dropTarget.classList.contains('drop-target')) return;
    if (dropTarget.querySelector(".draggable")) {
      dropTarget.classList.remove("empty-drop-target");
    } else {
      dropTarget.classList.add("empty-drop-target");
    }
  }

  // --- QUIZ FUNCTIONALITY (MODIFIED RESET) ---
  function submitQuiz() {
    let total = 0;
    let correct = 0;
    deselectItem(); // Ensure nothing is selected when submitting

    document.querySelectorAll('.question-box').forEach((box) => {
      total++;
      const correctAnswer = box.getAttribute("data-correct").trim();
      const dropTarget = box.querySelector(".drop-target");
      const droppedDraggable = dropTarget.querySelector(".draggable");
      dropTarget.classList.remove("correct", "incorrect");
      if (droppedDraggable) {
        const selectedText = droppedDraggable.textContent.trim();
        if (selectedText === correctAnswer) {
          dropTarget.classList.add("correct");
          correct++;
        } else {
          dropTarget.classList.add("incorrect");
        }
      } else {
        dropTarget.classList.add("incorrect");
      }
    });
    const resultDiv = document.getElementById("result");
    resultDiv.innerHTML =
      `Du hast <span class="correct-count">${correct}</span> von <span class="total-count">${total}</span> Fragen richtig beantwortet.`;
  }

  function resetQuiz() {
    deselectItem(); // Clear any click-selection first

    document.querySelectorAll('.drop-target').forEach(dt => {
        const draggable = dt.querySelector('.draggable');
        if (draggable) {
            rightColumnContent.appendChild(draggable);
            draggable.classList.remove('selected'); // Make sure it's not selected style
        }
        dt.innerHTML = '';
        dt.classList.remove('correct', 'incorrect');
        updateDropTargetVisualState(dt);
    });

    rightColumnContent.innerHTML = '';
    originalAnswerOrder.forEach(draggable => {
        rightColumnContent.appendChild(draggable);
        draggable.classList.remove('dragging'); // Just in case
        draggable.classList.remove('selected'); // Ensure no selected style
    });

    document.getElementById("result").innerHTML = "";
    document.querySelectorAll('.drop-target').forEach(updateDropTargetVisualState);
  }

  // --- INITIALIZATION ---
  document.querySelectorAll('.drop-target').forEach(updateDropTargetVisualState);
  initializeClickInteractions(); // Add this line to set up click listeners

</script>
<script>
let pingTimeout;
let logoutTimer;
let warningTimer;
let countdownTimer;
let lastPing = 0;

const INACTIVITY_LIMIT = 15 * 60 * 1000; // 15 minutes
const WARNING_BEFORE_LOGOUT = 30 * 1000; // 30 seconds
const warningBox = document.getElementById("warningBox");
const countdownEl = document.getElementById("countdown");

function sendPing() {
    const now = Date.now();
    if (now - lastPing < 10000) return; 
    lastPing = now;
    fetch("/ping").catch(() => {});
}

function resetTimers() {
    clearTimeout(pingTimeout);
    clearTimeout(logoutTimer);
    clearTimeout(warningTimer);
    clearInterval(countdownTimer);

    warningBox.style.display = "none"; // üü° hide warning if active again

    sendPing();
    pingTimeout = setTimeout(sendPing, 60 * 1000);

    // Show warning 30s before logout
    warningTimer = setTimeout(() => {
        let remaining = 30;
        warningBox.style.display = "block";
        countdownEl.textContent = remaining;

        countdownTimer = setInterval(() => {
            remaining--;
            countdownEl.textContent = remaining;
            if (remaining <= 0) {
                clearInterval(countdownTimer);
            }
        }, 1000);
    }, INACTIVITY_LIMIT - WARNING_BEFORE_LOGOUT);

    // Auto logout
    logoutTimer = setTimeout(() => {
        fetch("/logout", { method: "POST" })
          .then(() => window.location.href = "/");
    }, INACTIVITY_LIMIT);
}

// Events
["mousemove", "keydown", "scroll", "click", "touchstart"].forEach(evt => {
    document.addEventListener(evt, resetTimers);
});

window.addEventListener("pageshow", sendPing);
window.addEventListener("beforeunload", sendPing);

resetTimers();
</script>
</body></html>