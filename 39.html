<html lang="de"><head>
<meta charset="utf-8"/>
<title>Lesen Teil 1 - Jugend forscht</title>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
<style>
    :root {
      --primary-color: #3498db;
      --secondary-color: #2ecc71;
      --danger-color: #e74c3c;
      --light-bg: #ecf0f1;
      --dark-text: #2c3e50;
      --light-text: #ffffff;
      --border-radius: 10px;
      --box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      --box-shadow-hover: 0 8px 20px rgba(0,0,0,0.15);
    }
    *, *::before, *::after { box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', 'Roboto', Arial, sans-serif; margin: 0; padding: 10px;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); color: var(--dark-text);
      animation: fadeInPage 0.8s ease-out; min-height: 100vh;
    }
    @media (min-width: 600px) { body { padding: 15px; } }
    @media (min-width: 992px) { body { padding: 20px; } }
    @keyframes fadeInPage { from { opacity: 0; transform: translateY(-15px); } to { opacity: 1; transform: translateY(0); } }
    .main-header {
      background-color: var(--primary-color); color: var(--light-text); padding: 12px 15px;
      font-size: 20px; margin-bottom: 20px; border-radius: var(--border-radius);
      text-align: center; font-weight: 600; box-shadow: var(--box-shadow); letter-spacing: 0.5px;
    }
    @media (min-width: 768px) { .main-header { padding: 20px 25px; font-size: 26px; margin-bottom: 25px; } }
    .container { display: flex; flex-direction: row; justify-content: space-between; gap: 15px; }
    @media(min-width: 992px) { .container { gap: 20px; } }
    .left-column { width: 58%; flex-shrink: 0; }
    .right-column { width: 38%; flex-shrink: 0; }
    .quiz-scroll-container, .right-column-content {
      background-color: var(--light-text); border-radius: var(--border-radius); padding: 10px;
      box-shadow: var(--box-shadow); max-height: 75vh; overflow-y: auto; overflow-x: hidden;
      scrollbar-width: thin; scrollbar-color: var(--primary-color) var(--light-bg);
    }
    @media (min-width: 992px) { .quiz-scroll-container, .right-column-content { padding: 15px; max-height: 70vh; } }
    .quiz-scroll-container::-webkit-scrollbar, .right-column-content::-webkit-scrollbar { width: 6px; }
    @media (min-width: 992px) { .quiz-scroll-container::-webkit-scrollbar, .right-column-content::-webkit-scrollbar { width: 8px; } }
    .quiz-scroll-container::-webkit-scrollbar-track, .right-column-content::-webkit-scrollbar-track { background: var(--light-bg); border-radius: var(--border-radius); }
    .quiz-scroll-container::-webkit-scrollbar-thumb, .right-column-content::-webkit-scrollbar-thumb { background-color: var(--primary-color); border-radius: var(--border-radius); border: 2px solid var(--light-bg); }
    .question-box {
      border: 1px solid #bdc3c7; border-left: 4px solid var(--primary-color); border-radius: var(--border-radius);
      margin-bottom: 15px; padding: 10px; background-color: #fdfdfd;
      transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
      display: flex; flex-direction: column; min-height: 120px;
    }
    @media (min-width: 992px) { .question-box { border-left-width: 5px; margin-bottom: 20px; padding: 15px; min-height: 150px; } }
    .question-box:hover { transform: translateY(-3px); box-shadow: var(--box-shadow-hover); }
    .email-fields { margin-bottom: 8px; }
    @media (min-width: 992px) { .email-fields { margin-bottom: 10px; } }
    .drop-target {
      background-color: #f9f9f9; padding: 10px; border: 2px dashed #cccccc; min-height: 40px;
      border-radius: 6px; text-align: center; transition: background-color 0.3s, border-color 0.3s;
      display: flex; align-items: center; justify-content: center; position: relative; cursor: pointer; /* Added cursor */
    }
    @media (min-width: 992px) { .drop-target { padding: 12px; min-height: 45px; border-radius: 8px; } }
    .drop-target.empty-drop-target::before { content: "Drop here"; color: #aaa; font-style: italic; font-size: 0.8em; }
    @media (min-width: 992px) { .drop-target.empty-drop-target::before { content: "Antwort hier ablegen"; font-size: 0.9em; } }
    .drop-target:not(.empty-drop-target)::before { content: ""; }
    .drop-target:hover, .drop-target.drag-over { background-color: #eef8ff; border-color: var(--primary-color); }
    .question-text { font-size: 0.8em; color: #555; line-height: 1.5; overflow-y: auto; max-height: 200px; padding-right: 5px; }
    @media (min-width: 992px) { .question-text { font-size: 0.9em; line-height: 1.6; max-height: 300px; } }
    .draggable {
      background-color: #e0e0e0; color: var(--dark-text); margin: 8px 0; padding: 8px 10px;
      border-radius: 6px; cursor: grab; display: flex; align-items: center; justify-content: center;
      transition: background-color 0.3s, transform 0.2s, box-shadow 0.2s, outline 0.2s;
      user-select: none; font-size: 0.85em; box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      text-align: center; word-break: break-word;
    }
    @media (min-width: 992px) { .draggable { margin: 10px 0; padding: 12px 15px; border-radius: 8px; font-size: 0.95em; } }
    .draggable:hover { background-color: #d0d0d0; transform: scale(1.02); box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
    .draggable.dragging { opacity: 0.6; transform: scale(0.95); box-shadow: 0 10px 20px rgba(0,0,0,0.2); cursor: grabbing; }

    /* NEW CSS for selected draggable */
    .draggable.selected {
      outline: 3px solid var(--primary-color);
      transform: scale(1.03);
      box-shadow: 0 0 10px rgba(52, 152, 219, 0.5);
      background-color: #ddeeff;
    }
    .draggable.selected:hover {
        background-color: #cce7ff;
        transform: scale(1.03);
    }

    .drop-target.correct { background-color: #e8f5e9 !important; border: 2px solid var(--secondary-color) !important; }
    .drop-target.correct::after {
      content: "\f00c"; font-family: "Font Awesome 6 Free"; font-weight: 900; color: var(--secondary-color);
      position: absolute; right: 5px; top: 50%; transform: translateY(-50%); font-size: 1em;
    }
    @media (min-width: 992px) { .drop-target.correct::after { right: 10px; font-size: 1.2em; } }
    .drop-target.incorrect { background-color: #ffebee !important; border: 2px solid var(--danger-color) !important; }
    .drop-target.incorrect::after {
      content: "\f00d"; font-family: "Font Awesome 6 Free"; font-weight: 900; color: var(--danger-color);
      position: absolute; right: 5px; top: 50%; transform: translateY(-50%); font-size: 1em;
    }
    @media (min-width: 992px) { .drop-target.incorrect::after { right: 10px; font-size: 1.2em; } }
    .drop-target .draggable { background-color: var(--primary-color); color: var(--light-text); width: calc(100% - 25px); padding-right: 0; margin: 0; }
    @media (min-width: 992px) { .drop-target .draggable { width: calc(100% - 40px); } }
    .drop-target.correct .draggable { background-color: var(--secondary-color) !important; }
    .drop-target.incorrect .draggable { background-color: var(--danger-color) !important; }
    .button-container { margin-top: 20px; display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; }
    @media (min-width: 992px) { .button-container { margin-top: 25px; gap: 15px; } }
    .quiz-button, .quiz-button-link {
      padding: 10px 20px; border: none; background-color: var(--primary-color); color: white !important;
      font-size: 14px; font-weight: 500; border-radius: var(--border-radius); cursor: pointer;
      transition: background-color 0.3s, transform 0.2s, box-shadow 0.2s;
      display: inline-flex; align-items: center; justify-content: center; gap: 8px;
      box-shadow: var(--box-shadow); text-decoration: none;
    }
    @media (min-width: 992px) { .quiz-button, .quiz-button-link { padding: 12px 25px; font-size: 16px; } }
    .quiz-button:hover, .quiz-button-link:hover { background-color: #2980b9; transform: translateY(-2px); box-shadow: var(--box-shadow-hover); color: white !important; }
    .quiz-button:active, .quiz-button-link:active { transform: translateY(0px); box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    .quiz-button.secondary, .quiz-button-link.secondary { background-color: #7f8c8d; }
    .quiz-button.secondary:hover, .quiz-button-link.secondary:hover { background-color: #6c7a89; }
    #result {
      text-align: center; margin-top: 20px; padding: 12px; font-size: 1em; font-weight: 500;
      background-color: var(--light-text); border-radius: var(--border-radius); box-shadow: var(--box-shadow);
    }
    @media (min-width: 992px) { #result { margin-top: 25px; padding: 15px; font-size: 1.1em; } }
    #result .correct-count { color: var(--secondary-color); }
    #result .total-count { color: var(--primary-color); }

    #warningBox {
  display: none;
  position: fixed;
  top: 20px;                  
  left: 50%;                  
  transform: translateX(-50%);
  background: #f81d1d;
  color: #ffffff;
  padding: 15px 20px;
  border-radius: 10px;
  box-shadow: 0 0 10px rgba(0,0,0,0.3);
  font-family: Arial, sans-serif;
  font-size: 14px;
  font-weight: bold;
  z-index: 9999;
}
  </style>
</head>
<body>
<div class="main-header">Lesen Teil 1 - Jugend forscht</div>
<div class="container">
<div class="left-column">
<div class="quiz-scroll-container">
<!-- Question 1 -->
<div class="question-box" data-correct="Wenn aus Erdbeeren Tomaten werden.">
<div class="email-fields">
<div class="email-subject drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)"></div>
</div>
<div class="question-text">
          Die Zahlen wirken auf dem ersten Blick dramatisch:15 Prozent der Kinder sind √ºbergewichtig und davon sechs Prozent sogar fettleibig. Der Ern√§hrungswissenschaftler Timo Schmidt betreibt in Berlin ein Kochstudio f√ºr Kinder und Jugendliche. Timo Schmidt meint, es fehle vor allem an Praxis-Erfahrungen in der K√ºche. Kinder und Jugendliche k√∂nnen heute oft nicht (mehr) kochen, so seine Erfahrung. Das Interesse ist oft da, und die Kinder wollen kochen. Aber das Problem sind die Eltern. Oft haben sie keine Zeit, den Kindern alles zu erkl√§ren. Zum anderen haben sie Angst wegen der scharfen Messer. Dabei ist die Quote von Schnittverletzungen im Kinder- und Jugendkochstudio verschwindend gering. Besonders erschreckend findet Schmidt, dass viele Kinder Lebensmittel einfach nicht mehr erkennen. So standen im Kochstudio beispielsweise Erdbeeren auf dem Tisch, die dann f√ºr Tomaten gehalten wurden. Und ein gelber Zucchini wird gerne mal alles Banane bezeichnet. ‚ÄúWas fehlt, ist die Praxis‚Äù Praxis, meint Schmitt. ‚ÄúDeswegen schneiden die Kinder dann mit der stumpfen Seite des Messers oder wissen nicht, wie hei√üt die Pfanne beim Kochen wird‚Äù.
          </div>
</div>
<!-- Question 2 -->
<div class="question-box" data-correct="Von der Di√§t zur Krankheit/M√§dchen abnehmen Krankheiten.">
<div class="email-fields">
<div class="email-subject drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)"></div>
</div>
<div class="question-text">
          Immer mehr M√§dchen leiden an schweren Essst√∂rungen - und das, obwohl √Ñrzte und Fachleute seit Jahren vor den negativen Folgen des Schlankheitswahns warnen. Die Kinder- und Jugendpsychiatrie im Kinderkrankenhaus in Hannover schl√§gt jetzt Alarm. ‚ÄúAllein in den letzten zwei Jahren hat die Nachfrage f√ºr einen Therapieplatz um fast 50 Prozent zugenommen‚Äù, sagt der leitende Psychologe Gerd Kuznik. Von 33 zur Verf√ºgung stehenden Pl√§tzen in der Jugendpsychiatrie seien derzeit 25 von M√§dchen mit Essst√∂rungen belegt. ‚ÄúWir wissen l√§ngst, dass d√ºnn zu sein weder gesund noch lebensverl√§ngernd ist‚Äù, sagt Kuznik, ‚Äúdoch unsere Gesellschaft konfrontiert gerade junge M√§dchen noch immer mit v√∂llig √ºberzogenen Schlankheitsvorstellungen‚Äù. Das allein verursacht noch keine Essst√∂rung. ‚ÄúWenn aber noch ein grundlegendes famili√§res Problem hinzukommt, legen viele M√§dchen einen √ºbertriebenen Wert auf ihr Aussehen‚Äù. So berichtet eine 17-J√§hrige, dass sie aus dem Gef√ºhl heraus, ‚Äúnichts hinzubekommen‚Äù, eine Di√§t gemacht habe. Und die Di√§t war dann endlich etwas, das klappte. Als Folge davon hat sie nicht nur wie geplant zwei Kilo abgenommen, sondern dreizehn. So zieht Gerd Kuznik nicht nur in diesem Fall das Fazit: Mit einer harmlosen Di√§t f√§ngt es meist an, mit einer schweren Krankheit kann es enden.
        </div>
</div>
<!-- Question 3 -->
<div class="question-box" data-correct="Jugend engagiert sich f√ºr den Umweltschutz/Schulerwettbewerb Umweltschutz.">
<div class="email-fields">
<div class="email-subject drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)"></div>
</div>
<div class="question-text">
          Energiesparlampen, umweltfreundliche Elektroger√§te, Bio-Nagellack - sieht man sich die Themen an, mit denen sich die Teilnehmer des 46. Regionalwettbewerbs ‚ÄùJugend forscht‚Äù besch√§ftigt haben, wird vor allem eines klar: Das √∂kologische Bewusstsein hat die Klassenzimmer erreicht. Knapp 100 Sch√ºler nahmen an dem Wettbewerb teil. Die Teilnehmer schreckten auch vor komplexen Themen nicht zur√ºck. Die Zw√∂lftkl√§ssler Adrian, Thanh und Son besch√§ftigten sich mit der Herstellung k√ºnstlicher Muskeln. ‚ÄúDie Herausforderung war, sich mit drei Fachgebieten - Anatomie, Technik und Chemie ‚Äì zu besch√§ftigen‚Äù, sagt Adrian. Gelohnt hat es sich - in der Rubrik Technik erreichte die Gruppe den ersten Platz. In der Rubrik Arbeitswelt ermittelten die Abiturientinnen Yara-Alessandra und Bahir die √ñkobilanz von Gartenger√§ten. ‚ÄúWir haben festgestellt, dass Laubbl√§ser mit Benzinmotor nicht nur gro√üe Mengen Kohlenstoffdioxid produzieren, sie vernichten auch W√ºrmer und Insekten, die f√ºr das Gleichgewicht der Umwelt wichtig sind‚Äù, sagt Yara-Alessandra. Die Jury honorierte das Projekt mit dem zweiten Platz. Die Gewinner bereiten sich nun auf den Landeswettbewerb ‚ÄúJugend forscht‚Äù vor.
        </div>
</div>
<!-- Question 4 -->
<div class="question-box" data-correct="Jugend forscht - auch auf dem Meer.">
<div class="email-fields">
<div class="email-subject drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)"></div>
</div>
<div class="question-text">
          13,5 Meter lang und leuchtend gelb - die ‚ÄúAldebaran‚Äù zieht die Blicke im Jachthafen auf sich. F√ºr drei Sch√ºler aus Diepholz ist ein Traum wahr geworden. Als Meeresforscher auf See arbeiten sie an einem eigenen Forschungsprojekt. Sie nehmen am Meereswettbewerb ‚ÄúForschen auf See‚Äù teil. Ziel des Projektes: junge Leute an wissenschaftlichen Arbeiten heranzuf√ºhren. Die drei Sch√ºler Jonas, Annika und Katharina sind 17 Jahre alt. Ihr Thema: die Verschmutzung der Nordsee mit winzigen Plastikteilchen. Mit ihren Forschungen wollen die Sch√ºler die Aufmerksamkeit auf die Verschmutzung der Nordsee lenken. Zu Hause in Diepholz engagieren sich die drei in der Umwelt Arbeitsgruppe ihrer Schule. √úber die Verschmutzung der Meere mit winzigen Plastikteilchen und die Gefahren f√ºr Fische und Meeress√§uger wissen sie schon einiges. Mit ihren Untersuchungen wollen sie die Aufmerksamkeit auf das Problem lenken. Die Proben sind zwar noch nicht ausgewertet, die ersten Plastikteile haben die Jugendlichen aber schon gefunden. ‚ÄúEs sieht so aus, dass wir Ergebnisse kriegen, die gut f√ºr unser Projekt sind - aber nicht gut f√ºr die Umwelt‚Äù.
        </div>
</div>
<!-- Question 5 -->
<div class="question-box" data-correct="Psychoterror an der Schule.">
<div class="email-fields">
<div class="email-subject drop-target empty-drop-target" ondragover="allowDrop(event)" ondrop="drop(event)"></div>
</div>
<div class="question-text">
          Mobbing ist kein neues Ph√§nomen. Es ist auch in Schulen weitverbreitet. Da spricht zum Beispiel eine Lehrerin vor der Klasse negativ √ºber eine Sch√ºlerin, weil sie etwas nicht versteht oder immer wieder krank ist. Oder die Mitsch√ºler lachen oder lassen beleidigende Bemerkungen fallen, wenn ein bestimmter Sch√ºler sich zu Wort meldet. Da lauern Jungen einer 4. Klasse einem sch√ºchternen Mitsch√ºler auf dem Schulweg auf und erpressen von ihm Geld oder Kleidung. H√§ufig sind die Erwachsenen ratlos oder schauen weg, w√§hrend die Opfer die Schuld bei sich selbst suchen und zunehmend in eine soziale Isolation geraten. Lehrkr√§fte sind meist √ºberrascht, wenn man sie auf Mobbing in einer Klasse anspricht. Denn die Schikanen geschehen oft zu subtil und meist au√üerhalb des Unterrichts, w√§hrend der Pausen oder auf dem Schulweg. Sicherheitsrisiko f√ºr ihr Kind werden kann.</div>
</div>
</div>
</div>
<div class="right-column">
<div class="right-column-content" ondragover="allowDrop(event)" ondrop="drop(event)">
<div class="draggable" draggable="true" id="a1" ondragstart="drag(event)">Jugend forscht - auch auf dem Meer.</div>
<div class="draggable" draggable="true" id="a2" ondragstart="drag(event)">Jugend engagiert sich f√ºr den Umweltschutz/Schulerwettbewerb Umweltschutz.</div>
<div class="draggable" draggable="true" id="a3" ondragstart="drag(event)">Kochen f√ºr Eltern und Kinder.</div>
<div class="draggable" draggable="true" id="a4" ondragstart="drag(event)">Mehr Gewalt auf Schulh√∂fen.</div>
<div class="draggable" draggable="true" id="a5" ondragstart="drag(event)">Psychoterror an der Schule.</div>
<div class="draggable" draggable="true" id="a6" ondragstart="drag(event)">Schiffsreise f√ºr Jugendliche.</div>
<div class="draggable" draggable="true" id="a7" ondragstart="drag(event)">Starker Wettbewerb um Sch√ºler.</div>
<div class="draggable" draggable="true" id="a8" ondragstart="drag(event)">Von der Di√§t zur Krankheit/M√§dchen abnehmen Krankheiten.</div>
<div class="draggable" draggable="true" id="a9" ondragstart="drag(event)">Wenn Lernen krank macht.</div>
<div class="draggable" draggable="true" id="a10" ondragstart="drag(event)">Wenn aus Erdbeeren Tomaten werden.</div>
</div>
</div>
</div>
<div class="button-container">
<button class="quiz-button" onclick="submitQuiz()">
<i class="fas fa-paper-plane"></i> Abschicken
  </button>
<button class="quiz-button secondary" onclick="resetQuiz()">
<i class="fas fa-redo"></i> Zur√ºcksetzen
  </button>
<a class="quiz-button-link secondary" href="/index2"> <!-- Replace # with your actual home link -->
<i class="fas fa-home"></i> Zur√ºck zur Startseite
  </a>
</div>
<div id="result"></div>
<script>
  const rightColumnContent = document.querySelector(".right-column .right-column-content");
  const originalAnswerOrder = Array.from(rightColumnContent.querySelectorAll('.draggable'));
  let selectedDraggable = null; // To store the currently click-selected draggable item

  // --- CLICK-TO-DROP/PICKUP LOGIC ---
  function selectItem(item) {
    if (selectedDraggable) {
      selectedDraggable.classList.remove('selected');
    }
    selectedDraggable = item;
    if (selectedDraggable) {
      selectedDraggable.classList.add('selected');
    }
  }

  function deselectItem() {
    if (selectedDraggable) {
      selectedDraggable.classList.remove('selected');
      selectedDraggable = null;
    }
  }

  function handleDraggableClicked(event) {
    const clickedItem = event.currentTarget;
    event.stopPropagation(); // Prevent click bubbling to parent elements like answer pool

    if (selectedDraggable === clickedItem) { // Clicking the already selected item
      deselectItem();
      // If it was in a target and now deselected by clicking it, move it back to pool
      if (clickedItem.parentElement.classList.contains('drop-target')) {
           const parentDropTarget = clickedItem.parentElement;
           rightColumnContent.appendChild(clickedItem);
           updateDropTargetVisualState(parentDropTarget);
           parentDropTarget.classList.remove('correct', 'incorrect'); // Clear feedback
      }
    } else { // Clicking a new item, or an unselected item in a target
      // If the clicked item is currently in a drop target, "pick it up" by moving to pool first
      if (clickedItem.parentElement.classList.contains('drop-target')) {
          const parentDropTarget = clickedItem.parentElement;
          rightColumnContent.appendChild(clickedItem); // Move to pool
          updateDropTargetVisualState(parentDropTarget);
          parentDropTarget.classList.remove('correct', 'incorrect'); // Clear feedback
      }
      selectItem(clickedItem); // Then select it (it's now in the pool)
    }
  }

  function handleDropTargetClicked(event) {
    const clickedDropTarget = event.currentTarget;
    event.stopPropagation();

    if (selectedDraggable) { // If an item is selected, try to place it here
      const existingItemInTarget = clickedDropTarget.querySelector('.draggable');
      if (existingItemInTarget && existingItemInTarget !== selectedDraggable) {
        rightColumnContent.appendChild(existingItemInTarget); // Move old item from target back to pool
        // No need to deselect existingItemInTarget here, as it wasn't the 'selectedDraggable'
      }

      clickedDropTarget.innerHTML = ''; // Clear target (removes placeholder or old item)
      clickedDropTarget.appendChild(selectedDraggable); // Place new item
      updateDropTargetVisualState(clickedDropTarget);
      clickedDropTarget.classList.remove('correct', 'incorrect'); // Clear any feedback
      deselectItem(); // Item is placed, so deselect
    } else if (!selectedDraggable && clickedDropTarget.querySelector('.draggable')) {
      // No item is selected, AND the clicked drop target HAS an item: "pick up" that item.
      const itemToPickUp = clickedDropTarget.querySelector('.draggable');
      rightColumnContent.appendChild(itemToPickUp); // Move it to the pool
      updateDropTargetVisualState(clickedDropTarget);
      clickedDropTarget.classList.remove('correct', 'incorrect'); // Clear feedback
      selectItem(itemToPickUp); // And select it (it's now in the pool)
    }
  }

  function handleAnswerPoolClicked(event) {
    // If click is on the pool itself (not a draggable within it) and an item is selected
    if (event.target === rightColumnContent && selectedDraggable) {
      // If selected item is somehow not in pool (e.g. if logic changes), ensure it is
      if (selectedDraggable.parentElement !== rightColumnContent) {
           rightColumnContent.appendChild(selectedDraggable);
      }
      // The main purpose here: clicking the pool with a selected item deselects it.
      deselectItem();
    }
  }

  function initializeClickInteractions() {
    document.querySelectorAll('.draggable').forEach(item => {
      item.addEventListener('click', handleDraggableClicked);
    });
    document.querySelectorAll('.drop-target').forEach(target => {
      target.addEventListener('click', handleDropTargetClicked);
    });
    rightColumnContent.addEventListener('click', handleAnswerPoolClicked);
  }

  // --- DRAG AND DROP LOGIC (MODIFIED) ---
  function allowDrop(ev) {
    ev.preventDefault();
    let potentialDropTarget = ev.target;
    while(potentialDropTarget && !potentialDropTarget.classList.contains('drop-target') && !potentialDropTarget.classList.contains('right-column-content')) {
        potentialDropTarget = potentialDropTarget.parentElement;
    }
    if (potentialDropTarget && potentialDropTarget.classList.contains('drop-target')) {
        potentialDropTarget.classList.add("drag-over");
    }
  }

  document.addEventListener('dragleave', function(event) {
    if (event.target.classList && event.target.classList.contains("drop-target")) {
      event.target.classList.remove("drag-over");
    }
  }, false);

  function drag(ev) {
    ev.dataTransfer.setData("text", ev.target.id);
    ev.target.classList.add("dragging");
    deselectItem(); // Deselect any click-selected item when a drag operation starts
  }

  document.addEventListener('dragend', function(event) {
    if (event.target.classList && event.target.classList.contains('draggable')) {
      event.target.classList.remove('dragging');
    }
    document.querySelectorAll('.drop-target.drag-over').forEach(dt => dt.classList.remove('drag-over'));
  });

  function drop(ev) {
    ev.preventDefault();
    const draggedId = ev.dataTransfer.getData("text");
    const draggedEl = document.getElementById(draggedId);
    let dropTargetEl = ev.target;

    if (!draggedEl) return; // Safety check

    draggedEl.classList.remove("dragging");
    document.querySelectorAll('.drop-target.drag-over').forEach(dt => dt.classList.remove('drag-over'));

    while (dropTargetEl &&
           !dropTargetEl.classList.contains("drop-target") &&
           !dropTargetEl.classList.contains("right-column-content")) {
      dropTargetEl = dropTargetEl.parentElement;
    }

    if (!dropTargetEl) return;

    if (dropTargetEl.classList.contains("drop-target")) {
      const currentAnswer = dropTargetEl.querySelector(".draggable");
      if (currentAnswer && currentAnswer !== draggedEl) {
        rightColumnContent.appendChild(currentAnswer);
        currentAnswer.classList.remove('selected'); // Ensure item moved back is not selected
      }
      dropTargetEl.innerHTML = "";
      dropTargetEl.appendChild(draggedEl);
      dropTargetEl.classList.remove("correct", "incorrect");
      updateDropTargetVisualState(dropTargetEl);
    }
    else if (dropTargetEl.classList.contains("right-column-content")) {
      const originalParent = draggedEl.parentElement; // Get parent BEFORE moving
      rightColumnContent.appendChild(draggedEl);
      if (originalParent && originalParent.classList.contains('drop-target')) {
          updateDropTargetVisualState(originalParent); // Update visual state of original drop target
          originalParent.classList.remove('correct', 'incorrect');
      }
    }
    deselectItem(); // Deselect any click-selected item after a drop operation
  }

  function updateDropTargetVisualState(dropTarget) {
    if (!dropTarget || !dropTarget.classList.contains('drop-target')) return;
    if (dropTarget.querySelector(".draggable")) {
      dropTarget.classList.remove("empty-drop-target");
    } else {
      dropTarget.classList.add("empty-drop-target");
    }
  }

  // --- QUIZ FUNCTIONALITY (MODIFIED RESET) ---
  function submitQuiz() {
    let total = 0;
    let correct = 0;
    deselectItem(); // Ensure nothing is selected when submitting

    document.querySelectorAll('.question-box').forEach((box) => {
      total++;
      const correctAnswer = box.getAttribute("data-correct").trim();
      const dropTarget = box.querySelector(".drop-target");
      const droppedDraggable = dropTarget.querySelector(".draggable");
      dropTarget.classList.remove("correct", "incorrect");
      if (droppedDraggable) {
        const selectedText = droppedDraggable.textContent.trim();
        if (selectedText === correctAnswer) {
          dropTarget.classList.add("correct");
          correct++;
        } else {
          dropTarget.classList.add("incorrect");
        }
      } else {
        dropTarget.classList.add("incorrect");
      }
    });
    const resultDiv = document.getElementById("result");
    resultDiv.innerHTML =
      `Du hast <span class="correct-count">${correct}</span> von <span class="total-count">${total}</span> Fragen richtig beantwortet.`;
  }

  function resetQuiz() {
    deselectItem(); // Clear any click-selection first

    document.querySelectorAll('.drop-target').forEach(dt => {
        const draggable = dt.querySelector('.draggable');
        if (draggable) {
            rightColumnContent.appendChild(draggable);
            draggable.classList.remove('selected'); // Make sure it's not selected style
        }
        dt.innerHTML = '';
        dt.classList.remove('correct', 'incorrect');
        updateDropTargetVisualState(dt);
    });

    rightColumnContent.innerHTML = '';
    originalAnswerOrder.forEach(draggable => {
        rightColumnContent.appendChild(draggable);
        draggable.classList.remove('dragging'); // Just in case
        draggable.classList.remove('selected'); // Ensure no selected style
    });

    document.getElementById("result").innerHTML = "";
    document.querySelectorAll('.drop-target').forEach(updateDropTargetVisualState);
  }

  // --- INITIALIZATION ---
  document.querySelectorAll('.drop-target').forEach(updateDropTargetVisualState);
  initializeClickInteractions(); // Add this line to set up click listeners

</script>
<script>
let pingTimeout;
let logoutTimer;
let warningTimer;
let countdownTimer;
let lastPing = 0;

const INACTIVITY_LIMIT = 15 * 60 * 1000; // 15 minutes
const WARNING_BEFORE_LOGOUT = 30 * 1000; // 30 seconds
const warningBox = document.getElementById("warningBox");
const countdownEl = document.getElementById("countdown");

function sendPing() {
    const now = Date.now();
    if (now - lastPing < 10000) return; 
    lastPing = now;
    fetch("/ping").catch(() => {});
}

function resetTimers() {
    clearTimeout(pingTimeout);
    clearTimeout(logoutTimer);
    clearTimeout(warningTimer);
    clearInterval(countdownTimer);

    warningBox.style.display = "none"; // üü° hide warning if active again

    sendPing();
    pingTimeout = setTimeout(sendPing, 60 * 1000);

    // Show warning 30s before logout
    warningTimer = setTimeout(() => {
        let remaining = 30;
        warningBox.style.display = "block";
        countdownEl.textContent = remaining;

        countdownTimer = setInterval(() => {
            remaining--;
            countdownEl.textContent = remaining;
            if (remaining <= 0) {
                clearInterval(countdownTimer);
            }
        }, 1000);
    }, INACTIVITY_LIMIT - WARNING_BEFORE_LOGOUT);

    // Auto logout
    logoutTimer = setTimeout(() => {
        fetch("/logout", { method: "POST" })
          .then(() => window.location.href = "/");
    }, INACTIVITY_LIMIT);
}

// Events
["mousemove", "keydown", "scroll", "click", "touchstart"].forEach(evt => {
    document.addEventListener(evt, resetTimers);
});

window.addEventListener("pageshow", sendPing);
window.addEventListener("beforeunload", sendPing);

resetTimers();
</script>
</body></html>